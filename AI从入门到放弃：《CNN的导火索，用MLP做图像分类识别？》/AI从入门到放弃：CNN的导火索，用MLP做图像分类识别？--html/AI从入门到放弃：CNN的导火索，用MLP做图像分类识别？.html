
    <!DOCTYPE html>
    <html>
    <head>
      <meta charset="utf-8">
      <meta http-equiv="X-UA-Compatible" content="IE=edge">
      <!-- common.css -->
      <style>* {-webkit-tap-highlight-color: rgba(0,0,0,0);}html {-webkit-text-size-adjust: none;}body {font-family: -apple-system, Helvetica, Arial, sans-serif;margin: 0;padding: 20px;color: #333;word-wrap: break-word;}h1, h2, h3, h4, h5, h6 {line-height: 1.1;}img {max-width: 100% !important;height: auto;}blockquote {margin: 0;padding: 0 15px;color: #777;border-left: 4px solid #ddd;}hr {background-color: #ddd;border: 0;height: 1px;margin: 15px 0;}code {font-family: Menlo, Consolas, 'Ubuntu Mono', Monaco, 'source-code-pro', monospace;line-height: 1.4;margin: 0;padding: 0.2em 0;font-size: 90%;background-color: rgba(0,0,0,0.04);border-radius: 3px;}pre > code {margin: 0;padding: 0;font-size: 100%;word-break: normal;background: transparent;border: 0;}ol {list-style-type: decimal;}ol ol, ul ol {list-style-type: lower-latin;}ol ol ol, ul ol ol, ul ul ol, ol ul ol {list-style-type: lower-roman;}table {border-spacing: 0;border-collapse: collapse;margin-top: 0;margin-bottom: 16px;}table th {font-weight: bold;}table th, table td {padding: 6px 13px;border: 1px solid #ddd;}table tr {border-top: 1px solid #ccc;}table tr:nth-child(even) {background-color: #f8f8f8;}input[type="checkbox"] {cursor: default;margin-right: 0.5em;font-size: 13px;}.task-list-item {list-style-type: none;}.task-list-item+.task-list-item {margin-top: 3px;}.task-list-item input {float: left;margin: 0.3em 1em 0.25em -1.6em;vertical-align: middle;}#tag-field {margin: 8px 2px 10px;}#tag-field .tag {display: inline-block;background: #cadff3;border-radius: 4px;padding: 1px 8px;color: black;font-size: 12px;margin-right: 10px;line-height: 1.4;}</style>
      <!-- ace-static.css -->
      <style>.ace_static_highlight {white-space: pre-wrap;}.ace_static_highlight .ace_gutter {width: 2em;text-align: right;padding: 0 3px 0 0;margin-right: 3px;}.ace_static_highlight.ace_show_gutter > .ace_line {padding-left: 2.6em;}.ace_static_highlight .ace_line {position: relative;}.ace_static_highlight .ace_gutter-cell {-moz-user-select: -moz-none;-khtml-user-select: none;-webkit-user-select: none;user-select: none;top: 0;bottom: 0;left: 0;position: absolute;}.ace_static_highlight .ace_gutter-cell:before {content: counter(ace_line, decimal);counter-increment: ace_line;}.ace_static_highlight {counter-reset: ace_line;}</style>
      <style>.ace-tomorrow-night-eighties .ace_gutter {background: #272727;color: #CCC}.ace-tomorrow-night-eighties .ace_print-margin {width: 1px;background: #272727}.ace-tomorrow-night-eighties {background-color: #2D2D2D;color: #CCCCCC}.ace-tomorrow-night-eighties .ace_constant.ace_other,.ace-tomorrow-night-eighties .ace_cursor {color: #CCCCCC}.ace-tomorrow-night-eighties .ace_marker-layer .ace_selection {background: #515151}.ace-tomorrow-night-eighties.ace_multiselect .ace_selection.ace_start {box-shadow: 0 0 3px 0px #2D2D2D;}.ace-tomorrow-night-eighties .ace_marker-layer .ace_step {background: rgb(102, 82, 0)}.ace-tomorrow-night-eighties .ace_marker-layer .ace_bracket {margin: -1px 0 0 -1px;border: 1px solid #6A6A6A}.ace-tomorrow-night-bright .ace_stack {background: rgb(66, 90, 44)}.ace-tomorrow-night-eighties .ace_marker-layer .ace_active-line {background: #393939}.ace-tomorrow-night-eighties .ace_gutter-active-line {background-color: #393939}.ace-tomorrow-night-eighties .ace_marker-layer .ace_selected-word {border: 1px solid #515151}.ace-tomorrow-night-eighties .ace_invisible {color: #6A6A6A}.ace-tomorrow-night-eighties .ace_keyword,.ace-tomorrow-night-eighties .ace_meta,.ace-tomorrow-night-eighties .ace_storage,.ace-tomorrow-night-eighties .ace_storage.ace_type,.ace-tomorrow-night-eighties .ace_support.ace_type {color: #CC99CC}.ace-tomorrow-night-eighties .ace_keyword.ace_operator {color: #66CCCC}.ace-tomorrow-night-eighties .ace_constant.ace_character,.ace-tomorrow-night-eighties .ace_constant.ace_language,.ace-tomorrow-night-eighties .ace_constant.ace_numeric,.ace-tomorrow-night-eighties .ace_keyword.ace_other.ace_unit,.ace-tomorrow-night-eighties .ace_support.ace_constant,.ace-tomorrow-night-eighties .ace_variable.ace_parameter {color: #F99157}.ace-tomorrow-night-eighties .ace_invalid {color: #CDCDCD;background-color: #F2777A}.ace-tomorrow-night-eighties .ace_invalid.ace_deprecated {color: #CDCDCD;background-color: #CC99CC}.ace-tomorrow-night-eighties .ace_fold {background-color: #6699CC;border-color: #CCCCCC}.ace-tomorrow-night-eighties .ace_entity.ace_name.ace_function,.ace-tomorrow-night-eighties .ace_support.ace_function,.ace-tomorrow-night-eighties .ace_variable {color: #6699CC}.ace-tomorrow-night-eighties .ace_support.ace_class,.ace-tomorrow-night-eighties .ace_support.ace_type {color: #FFCC66}.ace-tomorrow-night-eighties .ace_heading,.ace-tomorrow-night-eighties .ace_markup.ace_heading,.ace-tomorrow-night-eighties .ace_string {color: #99CC99}.ace-tomorrow-night-eighties .ace_comment {color: #999999}.ace-tomorrow-night-eighties .ace_entity.ace_name.ace_tag,.ace-tomorrow-night-eighties .ace_entity.ace_other.ace_attribute-name,.ace-tomorrow-night-eighties .ace_meta.ace_tag,.ace-tomorrow-night-eighties .ace_variable {color: #F2777A}.ace-tomorrow-night-eighties .ace_indent-guide {background: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAACCAYAAACZgbYnAAAAEklEQVQImWPQ09NrYAgMjP4PAAtGAwchHMyAAAAAAElFTkSuQmCC) right repeat-y}</style>
      <!-- export.css -->
      <style>
        body{margin:0 auto;max-width:800px;line-height:1.4}
        #nav{margin:5px 0 10px;font-size:15px}
        #titlearea{border-bottom:1px solid #ccc;font-size:17px;padding:10px 0;}
        #contentarea{font-size:15px;margin:16px 0}
        .cell{outline:0;min-height:20px;margin:5px 0;padding:5px 0;}
        .code-cell{font-family:Menlo,Consolas,'Ubuntu Mono',Monaco,'source-code-pro',monospace;font-size:12px;}
        .latex-cell{white-space:pre-wrap;}
      </style>
      <!-- User CSS -->
      <style> .text-cell {font-size: 15px;}.code-cell {font-size: 12px;}.markdown-cell {font-size: 15px;}.latex-cell {font-size: 15px;}</style>
    </head>
    <body>
      
      <div id="titlearea">
        <h2>AI从入门到放弃：CNN的导火索，用MLP做图像分类识别？</h2>
      </div>
      <div id="contentarea"><div class="cell markdown-cell"><h1>一. 前言</h1>
<p>阅读本文的基础：</p>
<ol>
<li>
<p>我会认为你对BP神经网络有充分的了解，熟读过我上一篇文章，本文会大量引用上一篇文章的知识以及代码。</p>
</li>
<li>
<p>上一篇笔记的传送门：<a href="http://km.oa.com/articles/view/366930"><strong>《AI从入门到放弃：BP神经网络算法推导及代码实现笔记》</strong></a></p>
</li>
</ol>
<hr>
<h1>二. 用MLP做图像分类识别？</h1>
<ol>
<li>
<p>在没有CNN以及更先进的神经网络的时代，朴素的想法是用多层感知机（MLP）做图片分类的识别，没毛病</p>
</li>
<li>
<p>作为上篇笔记学习的延续，以及下一篇CNN的药引，使用MLP来做图片分类识别，实在是个不错的过度例子。通过这个例子，从思路上引出一系列的问题，我不卖关子，自问自答吧，即：</p>
<ul>
<li>
<p>MLP能做图片分类识别吗？--&gt; 答案是是可以的，上一篇我们是拟合非线性分类函数，这里是拟合图像特征，数学本质没区别。</p>
</li>
<li>
<p>MLP做这个事情效果如何？--&gt; 个人认知内，只能说一般一般。</p>
</li>
<li>
<p>MLP在这一领域效果一般，是有什么缺陷吗？ --&gt;  缺陷是有的，下文会详细说。</p>
</li>
<li>
<p>有更好的解决方案吗？ --&gt; 那也是必须有的，地球人火星人喵星人都知道有CNN等等更先进的东东；但是在没有这些东西存在的时代，你发明出来了，那才真是666。</p>
</li>
</ul>
</li>
</ol>
<hr>
<h1>三. 先上车</h1>
<h3>1. 数据源</h3>
<ul>
<li>
<p>数据源当然是图片，但是是经过数据化处理的图片，使用的是h5文件。h5文件简单说就是把数据按索引固化起来，挺简单的不多说，度度一下 --&gt; <a href="https://blog.csdn.net/csdn15698845876/article/details/73278120">h5py入门讲解</a></p>
</li>
<li>
<p>我们有3个h5文件，存着不重复的图片数据，分别是：</p>
<ul>
<li>
<p>train_catvnoncat.h5 (用来训练模型用的，一共有209张，其中有猫也有不是猫的图片，尺寸64*64像素)</p>
</li>
<li>
<p>test_catvnoncat.h5 （用来测试模型准确度的，一共有50张图片，，其中有猫也有不是猫的图片，尺寸64*64像素）</p>
</li>
<li>
<p>my_cat_misu.h5 （用来玩的，我家猫主子的1张照骗，尺寸64*64像素）</p>
</li>
</ul>
</li>
</ul>
<h3>2. 数据结构</h3>
<ul>
<li>拿train_catvnoncat.h5举例，这个文件有2个索引：
<ul>
<li>
<p>train_set_x：这是一个数组，因为是209张图片，所以数组长度是209。数组中的元素是一个 64*64*3 的矩阵。64*64是图片像素尺寸，3是什么鬼？别忘了这是彩色图片，3就是代表RGB这3个颜色通道的值。</p>
</li>
<li>
<p>train_set_y：图片标签数组，长度也是209，是209张图片的标签（label），对应数组下标的值是1时，代表这张图片是喵星人，0则代表不是。</p>
</li>
<li>
<p>同理，test_catvnoncat.h5 中有 test_set_x 和 test_set_y；my_cat_misu.h5 中有 mycat_set_x 和 mycat_set_y</p>
</li>
</ul>
</li>
</ul>
<h3>3. 告诉你怎么制作图片的h5文件，以后做cnn等模型训练时，非常有用</h3>
<ul>
<li>
<p>以我主子为例子：</p>
<ul>
<li>
<p>原图：<img src="resources/C557C61880CBC43A9C4E776802CC06D0.jpg" alt="safdsafs.jpg" width="5184" height="3456"></p>
</li>
<li>
<p>自己处理成64*64的图片，当然你也可以写代码做图片处理，我懒，交给你实现了：<br>
<img src="resources/630243EC928C70E4417306DFBB39A9D1.jpg" alt="misu.jpg" width="64" height="64"></p>
</li>
</ul>
</li>
<li>
<p>python代码，用到h5py库：</p>
<pre><div class="ace-tomorrow-night-eighties"><div class="ace_static_highlight ace_show_gutter" style="counter-reset:ace_line 0"><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_keyword">def</span> <span class="ace_identifier">save_imgs_to_h5file</span><span class="ace_paren ace_lparen">(</span><span class="ace_identifier">h5_fname</span>, <span class="ace_identifier">x_label</span>, <span class="ace_identifier">y_label</span>, <span class="ace_identifier">img_paths_list</span>, <span class="ace_identifier">img_label_list</span><span class="ace_paren ace_rparen">)</span>:
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>  <span class="ace_comment"># <span class="ace_cjk" style="width:NaNpx">构</span><span class="ace_cjk" style="width:NaNpx">造</span>n<span class="ace_cjk" style="width:NaNpx">张</span><span class="ace_cjk" style="width:NaNpx">图</span><span class="ace_cjk" style="width:NaNpx">片</span><span class="ace_cjk" style="width:NaNpx">的</span><span class="ace_cjk" style="width:NaNpx">随</span><span class="ace_cjk" style="width:NaNpx">机</span><span class="ace_cjk" style="width:NaNpx">矩</span><span class="ace_cjk" style="width:NaNpx">阵</span></span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>  <span class="ace_identifier">data_imgs</span> <span class="ace_keyword ace_operator">=</span> <span class="ace_identifier">np</span>.<span class="ace_identifier">random</span>.<span class="ace_identifier">rand</span><span class="ace_paren ace_lparen">(</span><span class="ace_support ace_function">len</span><span class="ace_paren ace_lparen">(</span><span class="ace_identifier">img_paths_list</span><span class="ace_paren ace_rparen">)</span>, <span class="ace_constant ace_numeric">64</span>, <span class="ace_constant ace_numeric">64</span>, <span class="ace_constant ace_numeric">3</span><span class="ace_paren ace_rparen">)</span>.<span class="ace_identifier">astype</span><span class="ace_paren ace_lparen">(</span><span class="ace_string">'int'</span><span class="ace_paren ace_rparen">)</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>  <span class="ace_identifier">label_imgs</span> <span class="ace_keyword ace_operator">=</span> <span class="ace_identifier">np</span>.<span class="ace_identifier">random</span>.<span class="ace_identifier">rand</span><span class="ace_paren ace_lparen">(</span><span class="ace_support ace_function">len</span><span class="ace_paren ace_lparen">(</span><span class="ace_identifier">img_paths_list</span><span class="ace_paren ace_rparen">)</span>, <span class="ace_constant ace_numeric">1</span><span class="ace_paren ace_rparen">)</span>.<span class="ace_identifier">astype</span><span class="ace_paren ace_lparen">(</span><span class="ace_string">'int'</span><span class="ace_paren ace_rparen">)</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>  <span class="ace_comment"># plt.imread<span class="ace_cjk" style="width:NaNpx">可</span><span class="ace_cjk" style="width:NaNpx">以</span><span class="ace_cjk" style="width:NaNpx">把</span><span class="ace_cjk" style="width:NaNpx">图</span><span class="ace_cjk" style="width:NaNpx">片</span><span class="ace_cjk" style="width:NaNpx">以</span><span class="ace_cjk" style="width:NaNpx">多</span><span class="ace_cjk" style="width:NaNpx">维</span><span class="ace_cjk" style="width:NaNpx">数</span><span class="ace_cjk" style="width:NaNpx">组</span><span class="ace_cjk" style="width:NaNpx">形</span><span class="ace_cjk" style="width:NaNpx">式</span><span class="ace_cjk" style="width:NaNpx">读</span><span class="ace_cjk" style="width:NaNpx">出</span><span class="ace_cjk" style="width:NaNpx">来</span><span class="ace_cjk" style="width:NaNpx">，</span><span class="ace_cjk" style="width:NaNpx">然</span><span class="ace_cjk" style="width:NaNpx">后</span><span class="ace_cjk" style="width:NaNpx">我</span><span class="ace_cjk" style="width:NaNpx">们</span><span class="ace_cjk" style="width:NaNpx">存</span><span class="ace_cjk" style="width:NaNpx">成</span> n*n*3 <span class="ace_cjk" style="width:NaNpx">的</span><span class="ace_cjk" style="width:NaNpx">矩</span><span class="ace_cjk" style="width:NaNpx">阵</span></span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>  <span class="ace_keyword">for</span> <span class="ace_identifier">i</span> <span class="ace_keyword">in</span> <span class="ace_support ace_function">range</span><span class="ace_paren ace_lparen">(</span><span class="ace_support ace_function">len</span><span class="ace_paren ace_lparen">(</span><span class="ace_identifier">img_paths_list</span><span class="ace_paren ace_rparen">))</span>:
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_indent-guide">    </span>  <span class="ace_identifier">data_imgs</span><span class="ace_paren ace_lparen">[</span><span class="ace_identifier">i</span><span class="ace_paren ace_rparen">]</span> <span class="ace_keyword ace_operator">=</span> <span class="ace_identifier">np</span>.<span class="ace_identifier">array</span><span class="ace_paren ace_lparen">(</span><span class="ace_identifier">plt</span>.<span class="ace_identifier">imread</span><span class="ace_paren ace_lparen">(</span><span class="ace_identifier">img_paths_list</span><span class="ace_paren ace_lparen">[</span><span class="ace_identifier">i</span><span class="ace_paren ace_rparen">]))</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_indent-guide">    </span>  <span class="ace_identifier">label_imgs</span><span class="ace_paren ace_lparen">[</span><span class="ace_identifier">i</span><span class="ace_paren ace_rparen">]</span> <span class="ace_keyword ace_operator">=</span> <span class="ace_identifier">np</span>.<span class="ace_identifier">array</span><span class="ace_paren ace_lparen">(</span><span class="ace_identifier">img_label_list</span><span class="ace_paren ace_lparen">[</span><span class="ace_identifier">i</span><span class="ace_paren ace_rparen">])</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>  <span class="ace_comment"># <span class="ace_cjk" style="width:NaNpx">创</span><span class="ace_cjk" style="width:NaNpx">建</span>h5<span class="ace_cjk" style="width:NaNpx">文</span><span class="ace_cjk" style="width:NaNpx">件</span><span class="ace_cjk" style="width:NaNpx">，</span><span class="ace_cjk" style="width:NaNpx">按</span><span class="ace_cjk" style="width:NaNpx">照</span><span class="ace_cjk" style="width:NaNpx">指</span><span class="ace_cjk" style="width:NaNpx">定</span><span class="ace_cjk" style="width:NaNpx">的</span><span class="ace_cjk" style="width:NaNpx">索</span><span class="ace_cjk" style="width:NaNpx">引</span>label<span class="ace_cjk" style="width:NaNpx">存</span><span class="ace_cjk" style="width:NaNpx">到</span><span class="ace_cjk" style="width:NaNpx">文</span><span class="ace_cjk" style="width:NaNpx">件</span><span class="ace_cjk" style="width:NaNpx">中</span><span class="ace_cjk" style="width:NaNpx">，</span><span class="ace_cjk" style="width:NaNpx">完</span><span class="ace_cjk" style="width:NaNpx">事</span><span class="ace_cjk" style="width:NaNpx">了</span></span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>  <span class="ace_identifier">f</span> <span class="ace_keyword ace_operator">=</span> <span class="ace_identifier">h5py</span>.<span class="ace_identifier">File</span><span class="ace_paren ace_lparen">(</span><span class="ace_identifier">h5_fname</span>, <span class="ace_string">'w'</span><span class="ace_paren ace_rparen">)</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>  <span class="ace_identifier">f</span>.<span class="ace_identifier">create_dataset</span><span class="ace_paren ace_lparen">(</span><span class="ace_identifier">x_label</span>, <span class="ace_identifier">data</span><span class="ace_keyword ace_operator">=</span><span class="ace_identifier">data_imgs</span><span class="ace_paren ace_rparen">)</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>  <span class="ace_identifier">f</span>.<span class="ace_identifier">create_dataset</span><span class="ace_paren ace_lparen">(</span><span class="ace_identifier">y_label</span>, <span class="ace_identifier">data</span><span class="ace_keyword ace_operator">=</span><span class="ace_identifier">label_imgs</span><span class="ace_paren ace_rparen">)</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>  <span class="ace_identifier">f</span>.<span class="ace_identifier">close</span><span class="ace_paren ace_lparen">(</span><span class="ace_paren ace_rparen">)</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>  <span class="ace_keyword">return</span> <span class="ace_identifier">data_imgs</span>, <span class="ace_identifier">label_imgs</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>  
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>  <span class="ace_comment">#<span class="ace_cjk" style="width:NaNpx">用</span><span class="ace_cjk" style="width:NaNpx">法</span></span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>  <span class="ace_comment"># <span class="ace_cjk" style="width:NaNpx">图</span><span class="ace_cjk" style="width:NaNpx">片</span>label<span class="ace_cjk" style="width:NaNpx">为</span>1<span class="ace_cjk" style="width:NaNpx">代</span><span class="ace_cjk" style="width:NaNpx">表</span><span class="ace_cjk" style="width:NaNpx">这</span><span class="ace_cjk" style="width:NaNpx">是</span><span class="ace_cjk" style="width:NaNpx">一</span><span class="ace_cjk" style="width:NaNpx">张</span><span class="ace_cjk" style="width:NaNpx">喵</span><span class="ace_cjk" style="width:NaNpx">星</span><span class="ace_cjk" style="width:NaNpx">人</span><span class="ace_cjk" style="width:NaNpx">的</span><span class="ace_cjk" style="width:NaNpx">图</span><span class="ace_cjk" style="width:NaNpx">片</span><span class="ace_cjk" style="width:NaNpx">，</span>0<span class="ace_cjk" style="width:NaNpx">代</span><span class="ace_cjk" style="width:NaNpx">表</span><span class="ace_cjk" style="width:NaNpx">不</span><span class="ace_cjk" style="width:NaNpx">是</span></span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>  <span class="ace_identifier">save_imgs_to_h5file</span><span class="ace_paren ace_lparen">(</span><span class="ace_string">'datasets/my_cat_misu.h5'</span>, <span class="ace_string">'mycat_set_x'</span>, <span class="ace_string">'mycat_set_y'</span>, <span class="ace_paren ace_lparen">[</span><span class="ace_string">'misu.jpg'</span><span class="ace_paren ace_rparen">]</span>,<span class="ace_paren ace_lparen">[</span><span class="ace_constant ace_numeric">1</span><span class="ace_paren ace_rparen">])</span>
</div></div></div></pre>
</li>
</ul>
<h3>4. 看看我的数据源的样子</h3>
<ul>
<li>
<p>用来训练的图片集合，209张：</p>
<p><img src="resources/BCDD7CADA14ADFC183B9AFBCCB0B8A1C.png" alt="cat_pics_train.png" width="576" height="1131"></p>
</li>
<li>
<p>用来校验模型准确度的图片集合， 50张</p>
<p><img src="resources/A3E4523C6F2874F6555CD9A1EAEBE5B0.png" alt="cat_pics_test.png" width="456" height="401"></p>
</li>
<li>
<p>用来玩的，主子照骗，1张：</p>
<p><img src="resources/CBCBF0C20D17CDDAC3EE968D43FC0B54.png" alt="cat_pics_my.png" width="144" height="144"></p>
</li>
</ul>
<hr>
<h1>四. 开车了</h1>
<h3>1. 如何设计模型：</h3>
<ul>
<li>
<p>输入层：<br>
我们的图片是64*64的像素尺寸，那么算上RGB三个通道的数据，我们把三维矩阵拉成面条 64*64*3 = 12288。 也就是我们输入层的数据长度是12288。</p>
</li>
<li>
<p>隐藏层：<br>
使用多层隐藏层，可以自行多尝试一下不同的结构。这里我使用3个隐藏层，隐藏层神经元个数分别是20，7，5</p>
</li>
<li>
<p>输出层：<br>
我们的目标就是判断某张图片是否是猫而已，所以输出层1个神经元，输出概率大于0.5认为是猫，小于等于0.5认为不是。</p>
</li>
</ul>
<blockquote>
<p>【插播】：有人会想，第一层隐藏层的神经元和输入层数量一致是不是会好点？理论上是会好点，但是这涉及到MLP的一个缺陷，因为全连接情况下，这样做，第一层的权重w参数就有1228的平方个，约为1.5个亿。如果图片更大呢？参数会成指数级膨胀，后果尽情想象。</p>
</blockquote>
<h3>2. 如何训练模型</h3>
<ul>
<li>还用说，把209张图片的数据扔到神经网络，完成一次迭代，然后训练1万次，可自行尝试迭不同代次数观察效果。</li>
</ul>
<h3>3. 如何衡量模型的准确度</h3>
<ul>
<li>
<p>大神吴恩达（Andrew Ng）提到的方法之一，就是划分不同集合，一部分用来训练，一部分用来验证模型效果，这样可以达到衡量你所训练的模型的效果如何。所以我们训练使用209张图片，最终使用50张测试模型效果。</p>
</li>
<li>
<p>为了好玩，可以自己用不同图片通过模型去做分类识别。</p>
</li>
</ul>
<hr>
<h1>五. 老规矩，甩代码</h1>
<p>还是说明一下代码流程吧：</p>
<ul>
<li>
<p>代码使用到的 NeuralNetwork 是我上一篇笔记的代码，实现了BP神经网络，import进来直接用即可。</p>
</li>
<li>
<p>代码做的事情就是：</p>
<ol>
<li>从h5文件加载图片数据</li>
<li>把原始图片显示出来，同时也保存成图片文件</li>
<li>训练神经网络模型</li>
<li>验证模型准确度</li>
<li>把识别结果标注到原始图片上，同时也保存成图片文件</li>
</ol>
</li>
</ul>
<pre><div class="ace-tomorrow-night-eighties"><div class="ace_static_highlight ace_show_gutter" style="counter-reset:ace_line 0"><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_comment">#coding:utf-8</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_keyword">import</span> <span class="ace_identifier">h5py</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_keyword">import</span> <span class="ace_identifier">matplotlib</span>.<span class="ace_identifier">font_manager</span> <span class="ace_keyword">as</span> <span class="ace_identifier">fm</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_keyword">import</span> <span class="ace_identifier">matplotlib</span>.<span class="ace_identifier">pyplot</span> <span class="ace_keyword">as</span> <span class="ace_identifier">plt</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_keyword">import</span> <span class="ace_identifier">numpy</span> <span class="ace_keyword">as</span> <span class="ace_identifier">np</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_keyword">from</span> <span class="ace_identifier">NeuralNetwork</span> <span class="ace_keyword">import</span> <span class="ace_keyword ace_operator">*</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_identifier">font</span> <span class="ace_keyword ace_operator">=</span> <span class="ace_identifier">fm</span>.<span class="ace_identifier">FontProperties</span><span class="ace_paren ace_lparen">(</span><span class="ace_identifier">fname</span><span class="ace_keyword ace_operator">=</span><span class="ace_string">'/System/Library/Fonts/STHeiti Light.ttc'</span><span class="ace_paren ace_rparen">)</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_keyword">def</span> <span class="ace_identifier">load_Cat_dataset</span><span class="ace_paren ace_lparen">(</span><span class="ace_paren ace_rparen">)</span>:
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>    <span class="ace_identifier">train_dataset</span> <span class="ace_keyword ace_operator">=</span> <span class="ace_identifier">h5py</span>.<span class="ace_identifier">File</span><span class="ace_paren ace_lparen">(</span><span class="ace_string">'datasets/train_catvnoncat.h5'</span>, <span class="ace_string">"r"</span><span class="ace_paren ace_rparen">)</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>    <span class="ace_identifier">train_set_x_orig</span> <span class="ace_keyword ace_operator">=</span> <span class="ace_identifier">np</span>.<span class="ace_identifier">array</span><span class="ace_paren ace_lparen">(</span><span class="ace_identifier">train_dataset</span><span class="ace_paren ace_lparen">[</span><span class="ace_string">"train_set_x"</span><span class="ace_paren ace_rparen">]</span><span class="ace_paren ace_lparen">[</span>:<span class="ace_paren ace_rparen">])</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>    <span class="ace_identifier">train_set_y_orig</span> <span class="ace_keyword ace_operator">=</span> <span class="ace_identifier">np</span>.<span class="ace_identifier">array</span><span class="ace_paren ace_lparen">(</span><span class="ace_identifier">train_dataset</span><span class="ace_paren ace_lparen">[</span><span class="ace_string">"train_set_y"</span><span class="ace_paren ace_rparen">]</span><span class="ace_paren ace_lparen">[</span>:<span class="ace_paren ace_rparen">])</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>    <span class="ace_identifier">test_dataset</span> <span class="ace_keyword ace_operator">=</span> <span class="ace_identifier">h5py</span>.<span class="ace_identifier">File</span><span class="ace_paren ace_lparen">(</span><span class="ace_string">'datasets/test_catvnoncat.h5'</span>, <span class="ace_string">"r"</span><span class="ace_paren ace_rparen">)</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>    <span class="ace_identifier">test_set_x_orig</span> <span class="ace_keyword ace_operator">=</span> <span class="ace_identifier">np</span>.<span class="ace_identifier">array</span><span class="ace_paren ace_lparen">(</span><span class="ace_identifier">test_dataset</span><span class="ace_paren ace_lparen">[</span><span class="ace_string">"test_set_x"</span><span class="ace_paren ace_rparen">]</span><span class="ace_paren ace_lparen">[</span>:<span class="ace_paren ace_rparen">])</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>    <span class="ace_identifier">test_set_y_orig</span> <span class="ace_keyword ace_operator">=</span> <span class="ace_identifier">np</span>.<span class="ace_identifier">array</span><span class="ace_paren ace_lparen">(</span><span class="ace_identifier">test_dataset</span><span class="ace_paren ace_lparen">[</span><span class="ace_string">"test_set_y"</span><span class="ace_paren ace_rparen">]</span><span class="ace_paren ace_lparen">[</span>:<span class="ace_paren ace_rparen">])</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>    <span class="ace_identifier">mycat_dataset</span> <span class="ace_keyword ace_operator">=</span> <span class="ace_identifier">h5py</span>.<span class="ace_identifier">File</span><span class="ace_paren ace_lparen">(</span><span class="ace_string">'datasets/my_cat_misu.h5'</span>, <span class="ace_string">"r"</span><span class="ace_paren ace_rparen">)</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>    <span class="ace_identifier">mycat_set_x_orig</span> <span class="ace_keyword ace_operator">=</span> <span class="ace_identifier">np</span>.<span class="ace_identifier">array</span><span class="ace_paren ace_lparen">(</span><span class="ace_identifier">mycat_dataset</span><span class="ace_paren ace_lparen">[</span><span class="ace_string">"mycat_set_x"</span><span class="ace_paren ace_rparen">]</span><span class="ace_paren ace_lparen">[</span>:<span class="ace_paren ace_rparen">])</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>    <span class="ace_identifier">mycat_set_y_orig</span> <span class="ace_keyword ace_operator">=</span> <span class="ace_identifier">np</span>.<span class="ace_identifier">array</span><span class="ace_paren ace_lparen">(</span><span class="ace_identifier">mycat_dataset</span><span class="ace_paren ace_lparen">[</span><span class="ace_string">"mycat_set_y"</span><span class="ace_paren ace_rparen">]</span><span class="ace_paren ace_lparen">[</span>:<span class="ace_paren ace_rparen">])</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>    <span class="ace_identifier">classes</span> <span class="ace_keyword ace_operator">=</span> <span class="ace_identifier">np</span>.<span class="ace_identifier">array</span><span class="ace_paren ace_lparen">(</span><span class="ace_identifier">test_dataset</span><span class="ace_paren ace_lparen">[</span><span class="ace_string">"list_classes"</span><span class="ace_paren ace_rparen">]</span><span class="ace_paren ace_lparen">[</span>:<span class="ace_paren ace_rparen">])</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>    <span class="ace_identifier">train_set_y_orig</span> <span class="ace_keyword ace_operator">=</span> <span class="ace_identifier">train_set_y_orig</span>.<span class="ace_identifier">reshape</span><span class="ace_paren ace_lparen">((</span><span class="ace_constant ace_numeric">1</span>, <span class="ace_identifier">train_set_y_orig</span>.<span class="ace_identifier">shape</span><span class="ace_paren ace_lparen">[</span><span class="ace_constant ace_numeric">0</span><span class="ace_paren ace_rparen">]))</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>    <span class="ace_identifier">test_set_y_orig</span> <span class="ace_keyword ace_operator">=</span> <span class="ace_identifier">test_set_y_orig</span>.<span class="ace_identifier">reshape</span><span class="ace_paren ace_lparen">((</span><span class="ace_constant ace_numeric">1</span>, <span class="ace_identifier">test_set_y_orig</span>.<span class="ace_identifier">shape</span><span class="ace_paren ace_lparen">[</span><span class="ace_constant ace_numeric">0</span><span class="ace_paren ace_rparen">]))</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>    <span class="ace_identifier">mycat_set_y_orig</span> <span class="ace_keyword ace_operator">=</span> <span class="ace_identifier">mycat_set_y_orig</span>.<span class="ace_identifier">reshape</span><span class="ace_paren ace_lparen">((</span><span class="ace_constant ace_numeric">1</span>, <span class="ace_identifier">mycat_set_y_orig</span>.<span class="ace_identifier">shape</span><span class="ace_paren ace_lparen">[</span><span class="ace_constant ace_numeric">0</span><span class="ace_paren ace_rparen">]))</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>    <span class="ace_keyword">return</span> <span class="ace_identifier">train_set_x_orig</span>, <span class="ace_identifier">train_set_y_orig</span>, <span class="ace_identifier">test_set_x_orig</span>, <span class="ace_identifier">test_set_y_orig</span>, <span class="ace_identifier">mycat_set_x_orig</span>, <span class="ace_identifier">mycat_set_y_orig</span>,<span class="ace_identifier">classes</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_keyword">def</span> <span class="ace_identifier">predict_by_modle</span><span class="ace_paren ace_lparen">(</span><span class="ace_identifier">x</span>, <span class="ace_identifier">y</span>, <span class="ace_identifier">nn</span><span class="ace_paren ace_rparen">)</span>:
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>    <span class="ace_identifier">m</span> <span class="ace_keyword ace_operator">=</span> <span class="ace_identifier">x</span>.<span class="ace_identifier">shape</span><span class="ace_paren ace_lparen">[</span><span class="ace_constant ace_numeric">1</span><span class="ace_paren ace_rparen">]</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>    <span class="ace_identifier">p</span> <span class="ace_keyword ace_operator">=</span> <span class="ace_identifier">np</span>.<span class="ace_identifier">zeros</span><span class="ace_paren ace_lparen">((</span><span class="ace_constant ace_numeric">1</span>,<span class="ace_identifier">m</span><span class="ace_paren ace_rparen">))</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>    <span class="ace_identifier">output</span>, <span class="ace_identifier">caches</span> <span class="ace_keyword ace_operator">=</span> <span class="ace_identifier">nn</span>.<span class="ace_identifier">forward_propagation</span><span class="ace_paren ace_lparen">(</span><span class="ace_identifier">x</span><span class="ace_paren ace_rparen">)</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>    <span class="ace_keyword">for</span> <span class="ace_identifier">i</span> <span class="ace_keyword">in</span> <span class="ace_support ace_function">range</span><span class="ace_paren ace_lparen">(</span><span class="ace_constant ace_numeric">0</span>, <span class="ace_identifier">output</span>.<span class="ace_identifier">shape</span><span class="ace_paren ace_lparen">[</span><span class="ace_constant ace_numeric">1</span><span class="ace_paren ace_rparen">])</span>:
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_indent-guide">    </span>    <span class="ace_keyword">if</span> <span class="ace_identifier">output</span><span class="ace_paren ace_lparen">[</span><span class="ace_constant ace_numeric">0</span>,<span class="ace_identifier">i</span><span class="ace_paren ace_rparen">]</span> <span class="ace_keyword ace_operator">&gt;</span> <span class="ace_constant ace_numeric">0.5</span>:
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_indent-guide">    </span><span class="ace_indent-guide">    </span>    <span class="ace_identifier">p</span><span class="ace_paren ace_lparen">[</span><span class="ace_constant ace_numeric">0</span>,<span class="ace_identifier">i</span><span class="ace_paren ace_rparen">]</span> <span class="ace_keyword ace_operator">=</span> <span class="ace_constant ace_numeric">1</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_indent-guide">    </span>    <span class="ace_keyword">else</span>:
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_indent-guide">    </span><span class="ace_indent-guide">    </span>    <span class="ace_identifier">p</span><span class="ace_paren ace_lparen">[</span><span class="ace_constant ace_numeric">0</span>,<span class="ace_identifier">i</span><span class="ace_paren ace_rparen">]</span> <span class="ace_keyword ace_operator">=</span> <span class="ace_constant ace_numeric">0</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>    <span class="ace_comment"># <span class="ace_cjk" style="width:NaNpx">预</span><span class="ace_cjk" style="width:NaNpx">测</span><span class="ace_cjk" style="width:NaNpx">出</span><span class="ace_cjk" style="width:NaNpx">来</span><span class="ace_cjk" style="width:NaNpx">的</span><span class="ace_cjk" style="width:NaNpx">结</span><span class="ace_cjk" style="width:NaNpx">果</span><span class="ace_cjk" style="width:NaNpx">和</span><span class="ace_cjk" style="width:NaNpx">期</span><span class="ace_cjk" style="width:NaNpx">望</span><span class="ace_cjk" style="width:NaNpx">的</span><span class="ace_cjk" style="width:NaNpx">结</span><span class="ace_cjk" style="width:NaNpx">果</span><span class="ace_cjk" style="width:NaNpx">比</span><span class="ace_cjk" style="width:NaNpx">对</span><span class="ace_cjk" style="width:NaNpx">，</span><span class="ace_cjk" style="width:NaNpx">看</span><span class="ace_cjk" style="width:NaNpx">看</span><span class="ace_cjk" style="width:NaNpx">准</span><span class="ace_cjk" style="width:NaNpx">确</span><span class="ace_cjk" style="width:NaNpx">率</span><span class="ace_cjk" style="width:NaNpx">多</span><span class="ace_cjk" style="width:NaNpx">少</span><span class="ace_cjk" style="width:NaNpx">：</span></span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>    <span class="ace_comment"># <span class="ace_cjk" style="width:NaNpx">比</span><span class="ace_cjk" style="width:NaNpx">如</span>100<span class="ace_cjk" style="width:NaNpx">张</span><span class="ace_cjk" style="width:NaNpx">预</span><span class="ace_cjk" style="width:NaNpx">测</span><span class="ace_cjk" style="width:NaNpx">图</span><span class="ace_cjk" style="width:NaNpx">片</span><span class="ace_cjk" style="width:NaNpx">里</span><span class="ace_cjk" style="width:NaNpx">有</span>50<span class="ace_cjk" style="width:NaNpx">张</span><span class="ace_cjk" style="width:NaNpx">猫</span><span class="ace_cjk" style="width:NaNpx">的</span><span class="ace_cjk" style="width:NaNpx">图</span><span class="ace_cjk" style="width:NaNpx">片</span><span class="ace_cjk" style="width:NaNpx">，</span><span class="ace_cjk" style="width:NaNpx">只</span><span class="ace_cjk" style="width:NaNpx">识</span><span class="ace_cjk" style="width:NaNpx">别</span><span class="ace_cjk" style="width:NaNpx">出</span>40<span class="ace_cjk" style="width:NaNpx">张</span><span class="ace_cjk" style="width:NaNpx">，</span><span class="ace_cjk" style="width:NaNpx">那</span><span class="ace_cjk" style="width:NaNpx">么</span><span class="ace_cjk" style="width:NaNpx">识</span><span class="ace_cjk" style="width:NaNpx">别</span><span class="ace_cjk" style="width:NaNpx">率</span><span class="ace_cjk" style="width:NaNpx">就</span><span class="ace_cjk" style="width:NaNpx">是</span>80%</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>    <span class="ace_keyword">print</span><span class="ace_paren ace_lparen">(</span><span class="ace_string">u"<span class="ace_cjk" style="width:NaNpx">识</span><span class="ace_cjk" style="width:NaNpx">别</span><span class="ace_cjk" style="width:NaNpx">率</span>: "</span>  <span class="ace_keyword ace_operator">+</span> <span class="ace_support ace_function">str</span><span class="ace_paren ace_lparen">(</span><span class="ace_identifier">np</span>.<span class="ace_support ace_function">sum</span><span class="ace_paren ace_lparen">((</span><span class="ace_identifier">p</span> <span class="ace_keyword ace_operator">==</span> <span class="ace_identifier">y</span><span class="ace_paren ace_rparen">)</span><span class="ace_keyword ace_operator">/</span><span class="ace_support ace_function">float</span><span class="ace_paren ace_lparen">(</span><span class="ace_identifier">m</span><span class="ace_paren ace_rparen">))))</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>    <span class="ace_keyword">return</span> <span class="ace_identifier">np</span>.<span class="ace_identifier">array</span><span class="ace_paren ace_lparen">(</span><span class="ace_identifier">p</span><span class="ace_paren ace_lparen">[</span><span class="ace_constant ace_numeric">0</span><span class="ace_paren ace_rparen">]</span>, <span class="ace_identifier">dtype</span><span class="ace_keyword ace_operator">=</span><span class="ace_identifier">np</span>.<span class="ace_support ace_function">int</span><span class="ace_paren ace_rparen">)</span>, <span class="ace_paren ace_lparen">(</span><span class="ace_identifier">p</span><span class="ace_keyword ace_operator">==</span><span class="ace_identifier">y</span><span class="ace_paren ace_rparen">)</span><span class="ace_paren ace_lparen">[</span><span class="ace_constant ace_numeric">0</span><span class="ace_paren ace_rparen">]</span>, <span class="ace_identifier">np</span>.<span class="ace_support ace_function">sum</span><span class="ace_paren ace_lparen">((</span><span class="ace_identifier">p</span> <span class="ace_keyword ace_operator">==</span> <span class="ace_identifier">y</span><span class="ace_paren ace_rparen">)</span><span class="ace_keyword ace_operator">/</span><span class="ace_support ace_function">float</span><span class="ace_paren ace_lparen">(</span><span class="ace_identifier">m</span><span class="ace_paren ace_rparen">))</span><span class="ace_keyword ace_operator">*</span><span class="ace_constant ace_numeric">100</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_keyword">def</span> <span class="ace_identifier">save_imgs_to_h5file</span><span class="ace_paren ace_lparen">(</span><span class="ace_identifier">h5_fname</span>, <span class="ace_identifier">x_label</span>, <span class="ace_identifier">y_label</span>, <span class="ace_identifier">img_paths_list</span>, <span class="ace_identifier">img_label_list</span><span class="ace_paren ace_rparen">)</span>:
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>    <span class="ace_identifier">data_imgs</span> <span class="ace_keyword ace_operator">=</span> <span class="ace_identifier">np</span>.<span class="ace_identifier">random</span>.<span class="ace_identifier">rand</span><span class="ace_paren ace_lparen">(</span><span class="ace_support ace_function">len</span><span class="ace_paren ace_lparen">(</span><span class="ace_identifier">img_paths_list</span><span class="ace_paren ace_rparen">)</span>, <span class="ace_constant ace_numeric">64</span>, <span class="ace_constant ace_numeric">64</span>, <span class="ace_constant ace_numeric">3</span><span class="ace_paren ace_rparen">)</span>.<span class="ace_identifier">astype</span><span class="ace_paren ace_lparen">(</span><span class="ace_string">'int'</span><span class="ace_paren ace_rparen">)</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>    <span class="ace_identifier">label_imgs</span> <span class="ace_keyword ace_operator">=</span> <span class="ace_identifier">np</span>.<span class="ace_identifier">random</span>.<span class="ace_identifier">rand</span><span class="ace_paren ace_lparen">(</span><span class="ace_support ace_function">len</span><span class="ace_paren ace_lparen">(</span><span class="ace_identifier">img_paths_list</span><span class="ace_paren ace_rparen">)</span>, <span class="ace_constant ace_numeric">1</span><span class="ace_paren ace_rparen">)</span>.<span class="ace_identifier">astype</span><span class="ace_paren ace_lparen">(</span><span class="ace_string">'int'</span><span class="ace_paren ace_rparen">)</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>    <span class="ace_keyword">for</span> <span class="ace_identifier">i</span> <span class="ace_keyword">in</span> <span class="ace_support ace_function">range</span><span class="ace_paren ace_lparen">(</span><span class="ace_support ace_function">len</span><span class="ace_paren ace_lparen">(</span><span class="ace_identifier">img_paths_list</span><span class="ace_paren ace_rparen">))</span>:
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_indent-guide">    </span>    <span class="ace_identifier">data_imgs</span><span class="ace_paren ace_lparen">[</span><span class="ace_identifier">i</span><span class="ace_paren ace_rparen">]</span> <span class="ace_keyword ace_operator">=</span> <span class="ace_identifier">np</span>.<span class="ace_identifier">array</span><span class="ace_paren ace_lparen">(</span><span class="ace_identifier">plt</span>.<span class="ace_identifier">imread</span><span class="ace_paren ace_lparen">(</span><span class="ace_identifier">img_paths_list</span><span class="ace_paren ace_lparen">[</span><span class="ace_identifier">i</span><span class="ace_paren ace_rparen">]))</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_indent-guide">    </span>    <span class="ace_identifier">label_imgs</span><span class="ace_paren ace_lparen">[</span><span class="ace_identifier">i</span><span class="ace_paren ace_rparen">]</span> <span class="ace_keyword ace_operator">=</span> <span class="ace_identifier">np</span>.<span class="ace_identifier">array</span><span class="ace_paren ace_lparen">(</span><span class="ace_identifier">img_label_list</span><span class="ace_paren ace_lparen">[</span><span class="ace_identifier">i</span><span class="ace_paren ace_rparen">])</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>    <span class="ace_identifier">f</span> <span class="ace_keyword ace_operator">=</span> <span class="ace_identifier">h5py</span>.<span class="ace_identifier">File</span><span class="ace_paren ace_lparen">(</span><span class="ace_identifier">h5_fname</span>, <span class="ace_string">'w'</span><span class="ace_paren ace_rparen">)</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>    <span class="ace_identifier">f</span>.<span class="ace_identifier">create_dataset</span><span class="ace_paren ace_lparen">(</span><span class="ace_identifier">x_label</span>, <span class="ace_identifier">data</span><span class="ace_keyword ace_operator">=</span><span class="ace_identifier">data_imgs</span><span class="ace_paren ace_rparen">)</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>    <span class="ace_identifier">f</span>.<span class="ace_identifier">create_dataset</span><span class="ace_paren ace_lparen">(</span><span class="ace_identifier">y_label</span>, <span class="ace_identifier">data</span><span class="ace_keyword ace_operator">=</span><span class="ace_identifier">label_imgs</span><span class="ace_paren ace_rparen">)</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>    <span class="ace_identifier">f</span>.<span class="ace_identifier">close</span><span class="ace_paren ace_lparen">(</span><span class="ace_paren ace_rparen">)</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>    <span class="ace_keyword">return</span> <span class="ace_identifier">data_imgs</span>, <span class="ace_identifier">label_imgs</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_keyword">if</span> <span class="ace_identifier">__name__</span> <span class="ace_keyword ace_operator">==</span> <span class="ace_string">"__main__"</span>:
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>    <span class="ace_comment"># <span class="ace_cjk" style="width:NaNpx">图</span><span class="ace_cjk" style="width:NaNpx">片</span>label<span class="ace_cjk" style="width:NaNpx">为</span>1<span class="ace_cjk" style="width:NaNpx">代</span><span class="ace_cjk" style="width:NaNpx">表</span><span class="ace_cjk" style="width:NaNpx">这</span><span class="ace_cjk" style="width:NaNpx">是</span><span class="ace_cjk" style="width:NaNpx">一</span><span class="ace_cjk" style="width:NaNpx">张</span><span class="ace_cjk" style="width:NaNpx">喵</span><span class="ace_cjk" style="width:NaNpx">星</span><span class="ace_cjk" style="width:NaNpx">人</span><span class="ace_cjk" style="width:NaNpx">的</span><span class="ace_cjk" style="width:NaNpx">图</span><span class="ace_cjk" style="width:NaNpx">片</span><span class="ace_cjk" style="width:NaNpx">，</span>0<span class="ace_cjk" style="width:NaNpx">代</span><span class="ace_cjk" style="width:NaNpx">表</span><span class="ace_cjk" style="width:NaNpx">不</span><span class="ace_cjk" style="width:NaNpx">是</span></span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>    <span class="ace_comment">#save_imgs_to_h5file('datasets/my_cat_misu.h5', 'mycat_set_x', 'mycat_set_y', ['misu.jpg'],[1])</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>    <span class="ace_identifier">train_set_x_orig</span>, <span class="ace_identifier">train_set_y_orig</span>, <span class="ace_identifier">test_set_x_orig</span>, <span class="ace_identifier">test_set_y_orig</span>, <span class="ace_identifier">mycat_set_x_orig</span>, <span class="ace_identifier">mycat_set_y_orig</span>, <span class="ace_identifier">classes</span> <span class="ace_keyword ace_operator">=</span> <span class="ace_identifier">load_Cat_dataset</span><span class="ace_paren ace_lparen">(</span><span class="ace_paren ace_rparen">)</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>    <span class="ace_identifier">train_x_flatten</span> <span class="ace_keyword ace_operator">=</span> <span class="ace_identifier">train_set_x_orig</span>.<span class="ace_identifier">reshape</span><span class="ace_paren ace_lparen">(</span><span class="ace_identifier">train_set_x_orig</span>.<span class="ace_identifier">shape</span><span class="ace_paren ace_lparen">[</span><span class="ace_constant ace_numeric">0</span><span class="ace_paren ace_rparen">]</span>, <span class="ace_keyword ace_operator">-</span><span class="ace_constant ace_numeric">1</span><span class="ace_paren ace_rparen">)</span>.<span class="ace_identifier">T</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>    <span class="ace_identifier">test_x_flatten</span> <span class="ace_keyword ace_operator">=</span> <span class="ace_identifier">test_set_x_orig</span>.<span class="ace_identifier">reshape</span><span class="ace_paren ace_lparen">(</span><span class="ace_identifier">test_set_x_orig</span>.<span class="ace_identifier">shape</span><span class="ace_paren ace_lparen">[</span><span class="ace_constant ace_numeric">0</span><span class="ace_paren ace_rparen">]</span>, <span class="ace_keyword ace_operator">-</span><span class="ace_constant ace_numeric">1</span><span class="ace_paren ace_rparen">)</span>.<span class="ace_identifier">T</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>    <span class="ace_identifier">mycat_x_flatten</span> <span class="ace_keyword ace_operator">=</span> <span class="ace_identifier">mycat_set_x_orig</span>.<span class="ace_identifier">reshape</span><span class="ace_paren ace_lparen">(</span><span class="ace_identifier">mycat_set_x_orig</span>.<span class="ace_identifier">shape</span><span class="ace_paren ace_lparen">[</span><span class="ace_constant ace_numeric">0</span><span class="ace_paren ace_rparen">]</span>, <span class="ace_keyword ace_operator">-</span><span class="ace_constant ace_numeric">1</span><span class="ace_paren ace_rparen">)</span>.<span class="ace_identifier">T</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>    <span class="ace_identifier">train_set_x</span> <span class="ace_keyword ace_operator">=</span> <span class="ace_identifier">train_x_flatten</span> <span class="ace_keyword ace_operator">/</span> <span class="ace_constant ace_numeric">255.</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>    <span class="ace_identifier">test_set_x</span> <span class="ace_keyword ace_operator">=</span> <span class="ace_identifier">test_x_flatten</span> <span class="ace_keyword ace_operator">/</span> <span class="ace_constant ace_numeric">255.</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>    <span class="ace_identifier">mycat_set_x</span> <span class="ace_keyword ace_operator">=</span> <span class="ace_identifier">mycat_x_flatten</span> <span class="ace_keyword ace_operator">/</span> <span class="ace_constant ace_numeric">255.</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>    <span class="ace_keyword">print</span><span class="ace_paren ace_lparen">(</span><span class="ace_string">u"<span class="ace_cjk" style="width:NaNpx">训</span><span class="ace_cjk" style="width:NaNpx">练</span><span class="ace_cjk" style="width:NaNpx">图</span><span class="ace_cjk" style="width:NaNpx">片</span><span class="ace_cjk" style="width:NaNpx">数</span><span class="ace_cjk" style="width:NaNpx">量</span>: %d"</span> <span class="ace_keyword ace_operator">%</span> <span class="ace_support ace_function">len</span><span class="ace_paren ace_lparen">(</span><span class="ace_identifier">train_set_x_orig</span><span class="ace_paren ace_rparen">))</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>    <span class="ace_keyword">print</span><span class="ace_paren ace_lparen">(</span><span class="ace_string">u"<span class="ace_cjk" style="width:NaNpx">测</span><span class="ace_cjk" style="width:NaNpx">试</span><span class="ace_cjk" style="width:NaNpx">图</span><span class="ace_cjk" style="width:NaNpx">片</span><span class="ace_cjk" style="width:NaNpx">数</span><span class="ace_cjk" style="width:NaNpx">量</span>: %d"</span> <span class="ace_keyword ace_operator">%</span> <span class="ace_support ace_function">len</span><span class="ace_paren ace_lparen">(</span><span class="ace_identifier">test_set_x_orig</span><span class="ace_paren ace_rparen">))</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>    <span class="ace_identifier">plt</span>.<span class="ace_identifier">figure</span><span class="ace_paren ace_lparen">(</span><span class="ace_identifier">figsize</span><span class="ace_keyword ace_operator">=</span><span class="ace_paren ace_lparen">(</span><span class="ace_constant ace_numeric">10</span>, <span class="ace_constant ace_numeric">20</span><span class="ace_paren ace_rparen">))</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>    <span class="ace_identifier">plt</span>.<span class="ace_identifier">subplots_adjust</span><span class="ace_paren ace_lparen">(</span><span class="ace_identifier">wspace</span><span class="ace_keyword ace_operator">=</span><span class="ace_constant ace_numeric">0</span>,<span class="ace_identifier">hspace</span><span class="ace_keyword ace_operator">=</span><span class="ace_constant ace_numeric">0.15</span><span class="ace_paren ace_rparen">)</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>    <span class="ace_keyword">for</span> <span class="ace_identifier">i</span> <span class="ace_keyword">in</span> <span class="ace_support ace_function">range</span><span class="ace_paren ace_lparen">(</span><span class="ace_support ace_function">len</span><span class="ace_paren ace_lparen">(</span><span class="ace_identifier">train_set_x_orig</span><span class="ace_paren ace_rparen">))</span>:
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_indent-guide">    </span>    <span class="ace_identifier">plt</span>.<span class="ace_identifier">subplot</span><span class="ace_paren ace_lparen">(</span><span class="ace_constant ace_numeric">21</span>,<span class="ace_constant ace_numeric">10</span>, <span class="ace_identifier">i</span><span class="ace_keyword ace_operator">+</span><span class="ace_constant ace_numeric">1</span><span class="ace_paren ace_rparen">)</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_indent-guide">    </span>    <span class="ace_identifier">plt</span>.<span class="ace_identifier">imshow</span><span class="ace_paren ace_lparen">(</span><span class="ace_identifier">train_set_x_orig</span><span class="ace_paren ace_lparen">[</span><span class="ace_identifier">i</span><span class="ace_paren ace_rparen">]</span>,<span class="ace_identifier">interpolation</span><span class="ace_keyword ace_operator">=</span><span class="ace_string">'none'</span>,<span class="ace_identifier">cmap</span><span class="ace_keyword ace_operator">=</span><span class="ace_string">'Reds_r'</span>,<span class="ace_identifier">vmin</span><span class="ace_keyword ace_operator">=</span><span class="ace_constant ace_numeric">0.6</span>,<span class="ace_identifier">vmax</span><span class="ace_keyword ace_operator">=</span><span class="ace_constant ace_numeric">.9</span><span class="ace_paren ace_rparen">)</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_indent-guide">    </span>    <span class="ace_identifier">plt</span>.<span class="ace_identifier">xticks</span><span class="ace_paren ace_lparen">([</span><span class="ace_paren ace_rparen">])</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_indent-guide">    </span>    <span class="ace_identifier">plt</span>.<span class="ace_identifier">yticks</span><span class="ace_paren ace_lparen">([</span><span class="ace_paren ace_rparen">])</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>    <span class="ace_identifier">plt</span>.<span class="ace_identifier">savefig</span><span class="ace_paren ace_lparen">(</span><span class="ace_string">"cat_pics_train.png"</span><span class="ace_paren ace_rparen">)</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>    <span class="ace_identifier">plt</span>.<span class="ace_identifier">show</span><span class="ace_paren ace_lparen">(</span><span class="ace_paren ace_rparen">)</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>    <span class="ace_identifier">plt</span>.<span class="ace_identifier">figure</span><span class="ace_paren ace_lparen">(</span><span class="ace_identifier">figsize</span><span class="ace_keyword ace_operator">=</span><span class="ace_paren ace_lparen">(</span><span class="ace_constant ace_numeric">8</span>, <span class="ace_constant ace_numeric">8</span><span class="ace_paren ace_rparen">))</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>    <span class="ace_identifier">plt</span>.<span class="ace_identifier">subplots_adjust</span><span class="ace_paren ace_lparen">(</span><span class="ace_identifier">wspace</span><span class="ace_keyword ace_operator">=</span><span class="ace_constant ace_numeric">0</span>, <span class="ace_identifier">hspace</span><span class="ace_keyword ace_operator">=</span><span class="ace_constant ace_numeric">0.1</span><span class="ace_paren ace_rparen">)</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>    <span class="ace_keyword">for</span> <span class="ace_identifier">i</span> <span class="ace_keyword">in</span> <span class="ace_support ace_function">range</span><span class="ace_paren ace_lparen">(</span><span class="ace_support ace_function">len</span><span class="ace_paren ace_lparen">(</span><span class="ace_identifier">test_set_x_orig</span><span class="ace_paren ace_rparen">))</span>:
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_indent-guide">    </span>    <span class="ace_identifier">ax</span> <span class="ace_keyword ace_operator">=</span> <span class="ace_identifier">plt</span>.<span class="ace_identifier">subplot</span><span class="ace_paren ace_lparen">(</span><span class="ace_constant ace_numeric">8</span>, <span class="ace_constant ace_numeric">8</span>, <span class="ace_identifier">i</span> <span class="ace_keyword ace_operator">+</span> <span class="ace_constant ace_numeric">1</span><span class="ace_paren ace_rparen">)</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_indent-guide">    </span>    <span class="ace_identifier">im</span> <span class="ace_keyword ace_operator">=</span> <span class="ace_identifier">ax</span>.<span class="ace_identifier">imshow</span><span class="ace_paren ace_lparen">(</span><span class="ace_identifier">test_set_x_orig</span><span class="ace_paren ace_lparen">[</span><span class="ace_identifier">i</span><span class="ace_paren ace_rparen">]</span>, <span class="ace_identifier">interpolation</span><span class="ace_keyword ace_operator">=</span><span class="ace_string">'none'</span>, <span class="ace_identifier">cmap</span><span class="ace_keyword ace_operator">=</span><span class="ace_string">'Reds_r'</span>, <span class="ace_identifier">vmin</span><span class="ace_keyword ace_operator">=</span><span class="ace_constant ace_numeric">0.6</span>, <span class="ace_identifier">vmax</span><span class="ace_keyword ace_operator">=</span><span class="ace_constant ace_numeric">.9</span><span class="ace_paren ace_rparen">)</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_indent-guide">    </span>    <span class="ace_identifier">plt</span>.<span class="ace_identifier">xticks</span><span class="ace_paren ace_lparen">([</span><span class="ace_paren ace_rparen">])</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_indent-guide">    </span>    <span class="ace_identifier">plt</span>.<span class="ace_identifier">yticks</span><span class="ace_paren ace_lparen">([</span><span class="ace_paren ace_rparen">])</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>    <span class="ace_identifier">plt</span>.<span class="ace_identifier">savefig</span><span class="ace_paren ace_lparen">(</span><span class="ace_string">"cat_pics_test.png"</span><span class="ace_paren ace_rparen">)</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>    <span class="ace_identifier">plt</span>.<span class="ace_identifier">show</span><span class="ace_paren ace_lparen">(</span><span class="ace_paren ace_rparen">)</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>    <span class="ace_identifier">plt</span>.<span class="ace_identifier">figure</span><span class="ace_paren ace_lparen">(</span><span class="ace_identifier">figsize</span><span class="ace_keyword ace_operator">=</span><span class="ace_paren ace_lparen">(</span><span class="ace_constant ace_numeric">2</span>, <span class="ace_constant ace_numeric">2</span><span class="ace_paren ace_rparen">))</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>    <span class="ace_identifier">plt</span>.<span class="ace_identifier">subplots_adjust</span><span class="ace_paren ace_lparen">(</span><span class="ace_identifier">wspace</span><span class="ace_keyword ace_operator">=</span><span class="ace_constant ace_numeric">0</span>, <span class="ace_identifier">hspace</span><span class="ace_keyword ace_operator">=</span><span class="ace_constant ace_numeric">0</span><span class="ace_paren ace_rparen">)</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>    <span class="ace_keyword">for</span> <span class="ace_identifier">i</span> <span class="ace_keyword">in</span> <span class="ace_support ace_function">range</span><span class="ace_paren ace_lparen">(</span><span class="ace_support ace_function">len</span><span class="ace_paren ace_lparen">(</span><span class="ace_identifier">mycat_set_x_orig</span><span class="ace_paren ace_rparen">))</span>:
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_indent-guide">    </span>    <span class="ace_identifier">ax</span> <span class="ace_keyword ace_operator">=</span> <span class="ace_identifier">plt</span>.<span class="ace_identifier">subplot</span><span class="ace_paren ace_lparen">(</span><span class="ace_constant ace_numeric">1</span>, <span class="ace_constant ace_numeric">1</span>, <span class="ace_identifier">i</span> <span class="ace_keyword ace_operator">+</span> <span class="ace_constant ace_numeric">1</span><span class="ace_paren ace_rparen">)</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_indent-guide">    </span>    <span class="ace_identifier">im</span> <span class="ace_keyword ace_operator">=</span> <span class="ace_identifier">ax</span>.<span class="ace_identifier">imshow</span><span class="ace_paren ace_lparen">(</span><span class="ace_identifier">mycat_set_x_orig</span><span class="ace_paren ace_lparen">[</span><span class="ace_identifier">i</span><span class="ace_paren ace_rparen">]</span>, <span class="ace_identifier">interpolation</span><span class="ace_keyword ace_operator">=</span><span class="ace_string">'none'</span>, <span class="ace_identifier">cmap</span><span class="ace_keyword ace_operator">=</span><span class="ace_string">'Reds_r'</span>, <span class="ace_identifier">vmin</span><span class="ace_keyword ace_operator">=</span><span class="ace_constant ace_numeric">0.6</span>, <span class="ace_identifier">vmax</span><span class="ace_keyword ace_operator">=</span><span class="ace_constant ace_numeric">.9</span><span class="ace_paren ace_rparen">)</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_indent-guide">    </span>    <span class="ace_identifier">plt</span>.<span class="ace_identifier">xticks</span><span class="ace_paren ace_lparen">([</span><span class="ace_paren ace_rparen">])</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_indent-guide">    </span>    <span class="ace_identifier">plt</span>.<span class="ace_identifier">yticks</span><span class="ace_paren ace_lparen">([</span><span class="ace_paren ace_rparen">])</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>    <span class="ace_identifier">plt</span>.<span class="ace_identifier">savefig</span><span class="ace_paren ace_lparen">(</span><span class="ace_string">"cat_pics_my.png"</span><span class="ace_paren ace_rparen">)</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>    <span class="ace_identifier">plt</span>.<span class="ace_identifier">show</span><span class="ace_paren ace_lparen">(</span><span class="ace_paren ace_rparen">)</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>    <span class="ace_comment"># <span class="ace_cjk" style="width:NaNpx">用</span><span class="ace_cjk" style="width:NaNpx">训</span><span class="ace_cjk" style="width:NaNpx">练</span><span class="ace_cjk" style="width:NaNpx">图</span><span class="ace_cjk" style="width:NaNpx">片</span><span class="ace_cjk" style="width:NaNpx">集</span><span class="ace_cjk" style="width:NaNpx">训</span><span class="ace_cjk" style="width:NaNpx">练</span><span class="ace_cjk" style="width:NaNpx">模</span><span class="ace_cjk" style="width:NaNpx">型</span></span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>    <span class="ace_identifier">layers_dims</span> <span class="ace_keyword ace_operator">=</span> <span class="ace_paren ace_lparen">[</span><span class="ace_constant ace_numeric">12288</span>, <span class="ace_constant ace_numeric">20</span>, <span class="ace_constant ace_numeric">7</span>, <span class="ace_constant ace_numeric">5</span>, <span class="ace_constant ace_numeric">1</span><span class="ace_paren ace_rparen">]</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>    <span class="ace_identifier">nn</span> <span class="ace_keyword ace_operator">=</span> <span class="ace_identifier">NeuralNetwork</span><span class="ace_paren ace_lparen">(</span><span class="ace_identifier">layers_dims</span>, <span class="ace_constant ace_language">True</span><span class="ace_paren ace_rparen">)</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>    <span class="ace_identifier">nn</span>.<span class="ace_identifier">set_xy</span><span class="ace_paren ace_lparen">(</span><span class="ace_identifier">train_set_x</span>, <span class="ace_identifier">train_set_y_orig</span><span class="ace_paren ace_rparen">)</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>    <span class="ace_identifier">nn</span>.<span class="ace_identifier">set_num_iterations</span><span class="ace_paren ace_lparen">(</span><span class="ace_constant ace_numeric">10000</span><span class="ace_paren ace_rparen">)</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>    <span class="ace_identifier">nn</span>.<span class="ace_identifier">set_learning_rate</span><span class="ace_paren ace_lparen">(</span><span class="ace_constant ace_numeric">0.0075</span><span class="ace_paren ace_rparen">)</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>    <span class="ace_identifier">nn</span>.<span class="ace_identifier">training_modle</span><span class="ace_paren ace_lparen">(</span><span class="ace_paren ace_rparen">)</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>    <span class="ace_comment"># <span class="ace_cjk" style="width:NaNpx">结</span><span class="ace_cjk" style="width:NaNpx">果</span><span class="ace_cjk" style="width:NaNpx">展</span><span class="ace_cjk" style="width:NaNpx">示</span><span class="ace_cjk" style="width:NaNpx">说</span><span class="ace_cjk" style="width:NaNpx">明</span><span class="ace_cjk" style="width:NaNpx">：</span></span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>    <span class="ace_comment"># <span class="ace_cjk" style="width:NaNpx">【</span><span class="ace_cjk" style="width:NaNpx">识</span><span class="ace_cjk" style="width:NaNpx">别</span><span class="ace_cjk" style="width:NaNpx">正</span><span class="ace_cjk" style="width:NaNpx">确</span><span class="ace_cjk" style="width:NaNpx">】</span><span class="ace_cjk" style="width:NaNpx">：</span></span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>    <span class="ace_comment">#   1.<span class="ace_cjk" style="width:NaNpx">原</span><span class="ace_cjk" style="width:NaNpx">图</span><span class="ace_cjk" style="width:NaNpx">是</span><span class="ace_cjk" style="width:NaNpx">猫</span><span class="ace_cjk" style="width:NaNpx">，</span><span class="ace_cjk" style="width:NaNpx">识</span><span class="ace_cjk" style="width:NaNpx">别</span><span class="ace_cjk" style="width:NaNpx">为</span><span class="ace_cjk" style="width:NaNpx">猫</span>  --&gt; <span class="ace_cjk" style="width:NaNpx">原</span><span class="ace_cjk" style="width:NaNpx">图</span><span class="ace_cjk" style="width:NaNpx">显</span><span class="ace_cjk" style="width:NaNpx">示</span></span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>    <span class="ace_comment">#   2.<span class="ace_cjk" style="width:NaNpx">原</span><span class="ace_cjk" style="width:NaNpx">图</span><span class="ace_cjk" style="width:NaNpx">不</span><span class="ace_cjk" style="width:NaNpx">是</span><span class="ace_cjk" style="width:NaNpx">猫</span><span class="ace_cjk" style="width:NaNpx">，</span><span class="ace_cjk" style="width:NaNpx">识</span><span class="ace_cjk" style="width:NaNpx">别</span><span class="ace_cjk" style="width:NaNpx">为</span><span class="ace_cjk" style="width:NaNpx">不</span><span class="ace_cjk" style="width:NaNpx">是</span><span class="ace_cjk" style="width:NaNpx">猫</span> --&gt; <span class="ace_cjk" style="width:NaNpx">降</span><span class="ace_cjk" style="width:NaNpx">低</span><span class="ace_cjk" style="width:NaNpx">显</span><span class="ace_cjk" style="width:NaNpx">示</span><span class="ace_cjk" style="width:NaNpx">亮</span><span class="ace_cjk" style="width:NaNpx">度</span></span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>    <span class="ace_comment"># <span class="ace_cjk" style="width:NaNpx">【</span><span class="ace_cjk" style="width:NaNpx">识</span><span class="ace_cjk" style="width:NaNpx">别</span><span class="ace_cjk" style="width:NaNpx">错</span><span class="ace_cjk" style="width:NaNpx">误</span><span class="ace_cjk" style="width:NaNpx">】</span><span class="ace_cjk" style="width:NaNpx">：</span></span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>    <span class="ace_comment">#   1.<span class="ace_cjk" style="width:NaNpx">原</span><span class="ace_cjk" style="width:NaNpx">图</span><span class="ace_cjk" style="width:NaNpx">是</span><span class="ace_cjk" style="width:NaNpx">猫</span><span class="ace_cjk" style="width:NaNpx">，</span><span class="ace_cjk" style="width:NaNpx">但</span><span class="ace_cjk" style="width:NaNpx">是</span><span class="ace_cjk" style="width:NaNpx">识</span><span class="ace_cjk" style="width:NaNpx">别</span><span class="ace_cjk" style="width:NaNpx">为</span><span class="ace_cjk" style="width:NaNpx">不</span><span class="ace_cjk" style="width:NaNpx">是</span><span class="ace_cjk" style="width:NaNpx">猫</span> --&gt; <span class="ace_cjk" style="width:NaNpx">标</span><span class="ace_cjk" style="width:NaNpx">红</span><span class="ace_cjk" style="width:NaNpx">显</span><span class="ace_cjk" style="width:NaNpx">示</span></span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>    <span class="ace_comment">#   2.<span class="ace_cjk" style="width:NaNpx">原</span><span class="ace_cjk" style="width:NaNpx">图</span><span class="ace_cjk" style="width:NaNpx">不</span><span class="ace_cjk" style="width:NaNpx">是</span><span class="ace_cjk" style="width:NaNpx">猫</span><span class="ace_cjk" style="width:NaNpx">，</span> <span class="ace_cjk" style="width:NaNpx">但</span><span class="ace_cjk" style="width:NaNpx">是</span><span class="ace_cjk" style="width:NaNpx">识</span><span class="ace_cjk" style="width:NaNpx">别</span><span class="ace_cjk" style="width:NaNpx">成</span><span class="ace_cjk" style="width:NaNpx">猫</span> --&gt; <span class="ace_cjk" style="width:NaNpx">标</span><span class="ace_cjk" style="width:NaNpx">红</span><span class="ace_cjk" style="width:NaNpx">显</span><span class="ace_cjk" style="width:NaNpx">示</span></span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>    <span class="ace_comment"># <span class="ace_cjk" style="width:NaNpx">训</span><span class="ace_cjk" style="width:NaNpx">练</span><span class="ace_cjk" style="width:NaNpx">用</span><span class="ace_cjk" style="width:NaNpx">的</span><span class="ace_cjk" style="width:NaNpx">图</span><span class="ace_cjk" style="width:NaNpx">片</span><span class="ace_cjk" style="width:NaNpx">走</span><span class="ace_cjk" style="width:NaNpx">一</span><span class="ace_cjk" style="width:NaNpx">遍</span><span class="ace_cjk" style="width:NaNpx">模</span><span class="ace_cjk" style="width:NaNpx">型</span><span class="ace_cjk" style="width:NaNpx">，</span><span class="ace_cjk" style="width:NaNpx">观</span><span class="ace_cjk" style="width:NaNpx">察</span><span class="ace_cjk" style="width:NaNpx">其</span><span class="ace_cjk" style="width:NaNpx">识</span><span class="ace_cjk" style="width:NaNpx">别</span><span class="ace_cjk" style="width:NaNpx">率</span></span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>    <span class="ace_identifier">plt</span>.<span class="ace_identifier">figure</span><span class="ace_paren ace_lparen">(</span><span class="ace_identifier">figsize</span><span class="ace_keyword ace_operator">=</span><span class="ace_paren ace_lparen">(</span><span class="ace_constant ace_numeric">10</span>, <span class="ace_constant ace_numeric">20</span><span class="ace_paren ace_rparen">))</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>    <span class="ace_identifier">plt</span>.<span class="ace_identifier">subplots_adjust</span><span class="ace_paren ace_lparen">(</span><span class="ace_identifier">wspace</span><span class="ace_keyword ace_operator">=</span><span class="ace_constant ace_numeric">0</span>, <span class="ace_identifier">hspace</span><span class="ace_keyword ace_operator">=</span><span class="ace_constant ace_numeric">0.15</span><span class="ace_paren ace_rparen">)</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>    <span class="ace_identifier">pred_train</span>, <span class="ace_identifier">true</span>, <span class="ace_identifier">accuracy</span> <span class="ace_keyword ace_operator">=</span> <span class="ace_identifier">predict_by_modle</span><span class="ace_paren ace_lparen">(</span><span class="ace_identifier">train_set_x</span>, <span class="ace_identifier">train_set_y_orig</span>, <span class="ace_identifier">nn</span><span class="ace_paren ace_rparen">)</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>    <span class="ace_keyword">for</span> <span class="ace_identifier">i</span> <span class="ace_keyword">in</span> <span class="ace_support ace_function">range</span><span class="ace_paren ace_lparen">(</span><span class="ace_support ace_function">len</span><span class="ace_paren ace_lparen">(</span><span class="ace_identifier">train_set_x_orig</span><span class="ace_paren ace_rparen">))</span>:
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_indent-guide">    </span>    <span class="ace_identifier">ax</span> <span class="ace_keyword ace_operator">=</span> <span class="ace_identifier">plt</span>.<span class="ace_identifier">subplot</span><span class="ace_paren ace_lparen">(</span><span class="ace_constant ace_numeric">21</span>, <span class="ace_constant ace_numeric">10</span>, <span class="ace_identifier">i</span> <span class="ace_keyword ace_operator">+</span> <span class="ace_constant ace_numeric">1</span><span class="ace_paren ace_rparen">)</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_indent-guide">    </span>    <span class="ace_identifier">x_data</span> <span class="ace_keyword ace_operator">=</span> <span class="ace_identifier">train_set_x_orig</span><span class="ace_paren ace_lparen">[</span><span class="ace_identifier">i</span><span class="ace_paren ace_rparen">]</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_indent-guide">    </span>    <span class="ace_keyword">if</span> <span class="ace_identifier">pred_train</span><span class="ace_paren ace_lparen">[</span><span class="ace_identifier">i</span><span class="ace_paren ace_rparen">]</span> <span class="ace_keyword ace_operator">==</span> <span class="ace_constant ace_numeric">0</span> <span class="ace_keyword">and</span> <span class="ace_identifier">train_set_y_orig</span><span class="ace_paren ace_lparen">[</span><span class="ace_constant ace_numeric">0</span><span class="ace_paren ace_rparen">]</span><span class="ace_paren ace_lparen">[</span><span class="ace_identifier">i</span><span class="ace_paren ace_rparen">]</span> <span class="ace_keyword ace_operator">==</span> <span class="ace_constant ace_numeric">0</span>:
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_indent-guide">    </span><span class="ace_indent-guide">    </span>    <span class="ace_identifier">x_data</span> <span class="ace_keyword ace_operator">=</span> <span class="ace_identifier">x_data</span><span class="ace_keyword ace_operator">/</span><span class="ace_constant ace_numeric">5</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_indent-guide">    </span>    <span class="ace_keyword">if</span> <span class="ace_identifier">true</span><span class="ace_paren ace_lparen">[</span><span class="ace_identifier">i</span><span class="ace_paren ace_rparen">]</span> <span class="ace_keyword ace_operator">==</span> <span class="ace_constant ace_language">False</span>:
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_indent-guide">    </span><span class="ace_indent-guide">    </span>    <span class="ace_identifier">x_data</span><span class="ace_paren ace_lparen">[</span>:, :, <span class="ace_constant ace_numeric">0</span><span class="ace_paren ace_rparen">]</span> <span class="ace_keyword ace_operator">=</span> <span class="ace_identifier">x_data</span><span class="ace_paren ace_lparen">[</span>:, :, <span class="ace_constant ace_numeric">0</span><span class="ace_paren ace_rparen">]</span> <span class="ace_keyword ace_operator">+</span> <span class="ace_paren ace_lparen">(</span><span class="ace_constant ace_numeric">255</span> <span class="ace_keyword ace_operator">-</span> <span class="ace_identifier">x_data</span><span class="ace_paren ace_lparen">[</span>:, :, <span class="ace_constant ace_numeric">0</span><span class="ace_paren ace_rparen">])</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_indent-guide">    </span>    <span class="ace_identifier">im</span> <span class="ace_keyword ace_operator">=</span> <span class="ace_identifier">plt</span>.<span class="ace_identifier">imshow</span><span class="ace_paren ace_lparen">(</span><span class="ace_identifier">x_data</span>,<span class="ace_identifier">interpolation</span><span class="ace_keyword ace_operator">=</span><span class="ace_string">'none'</span>,<span class="ace_identifier">cmap</span><span class="ace_keyword ace_operator">=</span><span class="ace_string">'Reds_r'</span>,<span class="ace_identifier">vmin</span><span class="ace_keyword ace_operator">=</span><span class="ace_constant ace_numeric">0.6</span>,<span class="ace_identifier">vmax</span><span class="ace_keyword ace_operator">=</span><span class="ace_constant ace_numeric">.9</span><span class="ace_paren ace_rparen">)</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_indent-guide">    </span>    <span class="ace_identifier">plt</span>.<span class="ace_identifier">xticks</span><span class="ace_paren ace_lparen">([</span><span class="ace_paren ace_rparen">])</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_indent-guide">    </span>    <span class="ace_identifier">plt</span>.<span class="ace_identifier">yticks</span><span class="ace_paren ace_lparen">([</span><span class="ace_paren ace_rparen">])</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>    <span class="ace_identifier">plt</span>.<span class="ace_identifier">suptitle</span><span class="ace_paren ace_lparen">(</span><span class="ace_string">u"Num Of Pictrues: %d</span><span class="ace_constant ace_language ace_escape">\n</span><span class="ace_string"> Accuracy: %.2f%%"</span> <span class="ace_keyword ace_operator">%</span> <span class="ace_paren ace_lparen">(</span><span class="ace_support ace_function">len</span><span class="ace_paren ace_lparen">(</span><span class="ace_identifier">train_set_x_orig</span><span class="ace_paren ace_rparen">)</span>, <span class="ace_identifier">accuracy</span><span class="ace_paren ace_rparen">)</span>, <span class="ace_identifier">y</span><span class="ace_keyword ace_operator">=</span><span class="ace_constant ace_numeric">0.92</span>, <span class="ace_identifier">fontsize</span><span class="ace_keyword ace_operator">=</span><span class="ace_constant ace_numeric">20</span><span class="ace_paren ace_rparen">)</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>    <span class="ace_identifier">plt</span>.<span class="ace_identifier">savefig</span><span class="ace_paren ace_lparen">(</span><span class="ace_string">"cat_pics_train_predict.png"</span><span class="ace_paren ace_rparen">)</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>    <span class="ace_identifier">plt</span>.<span class="ace_identifier">show</span><span class="ace_paren ace_lparen">(</span><span class="ace_paren ace_rparen">)</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>    <span class="ace_comment"># <span class="ace_cjk" style="width:NaNpx">不</span><span class="ace_cjk" style="width:NaNpx">属</span><span class="ace_cjk" style="width:NaNpx">于</span><span class="ace_cjk" style="width:NaNpx">训</span><span class="ace_cjk" style="width:NaNpx">练</span><span class="ace_cjk" style="width:NaNpx">图</span><span class="ace_cjk" style="width:NaNpx">片</span><span class="ace_cjk" style="width:NaNpx">集</span><span class="ace_cjk" style="width:NaNpx">合</span><span class="ace_cjk" style="width:NaNpx">的</span><span class="ace_cjk" style="width:NaNpx">测</span><span class="ace_cjk" style="width:NaNpx">试</span><span class="ace_cjk" style="width:NaNpx">图</span><span class="ace_cjk" style="width:NaNpx">片</span><span class="ace_cjk" style="width:NaNpx">，</span><span class="ace_cjk" style="width:NaNpx">走</span><span class="ace_cjk" style="width:NaNpx">一</span><span class="ace_cjk" style="width:NaNpx">遍</span><span class="ace_cjk" style="width:NaNpx">模</span><span class="ace_cjk" style="width:NaNpx">型</span><span class="ace_cjk" style="width:NaNpx">，</span><span class="ace_cjk" style="width:NaNpx">观</span><span class="ace_cjk" style="width:NaNpx">察</span><span class="ace_cjk" style="width:NaNpx">其</span><span class="ace_cjk" style="width:NaNpx">识</span><span class="ace_cjk" style="width:NaNpx">别</span><span class="ace_cjk" style="width:NaNpx">率</span></span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>    <span class="ace_identifier">plt</span>.<span class="ace_identifier">figure</span><span class="ace_paren ace_lparen">(</span><span class="ace_identifier">figsize</span><span class="ace_keyword ace_operator">=</span><span class="ace_paren ace_lparen">(</span><span class="ace_constant ace_numeric">8</span>, <span class="ace_constant ace_numeric">8</span><span class="ace_paren ace_rparen">))</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>    <span class="ace_identifier">plt</span>.<span class="ace_identifier">subplots_adjust</span><span class="ace_paren ace_lparen">(</span><span class="ace_identifier">wspace</span><span class="ace_keyword ace_operator">=</span><span class="ace_constant ace_numeric">0</span>, <span class="ace_identifier">hspace</span><span class="ace_keyword ace_operator">=</span><span class="ace_constant ace_numeric">0.1</span><span class="ace_paren ace_rparen">)</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>    <span class="ace_identifier">pred_test</span>, <span class="ace_identifier">true</span>, <span class="ace_identifier">accuracy</span> <span class="ace_keyword ace_operator">=</span> <span class="ace_identifier">predict_by_modle</span><span class="ace_paren ace_lparen">(</span><span class="ace_identifier">test_set_x</span>, <span class="ace_identifier">test_set_y_orig</span>, <span class="ace_identifier">nn</span><span class="ace_paren ace_rparen">)</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>    <span class="ace_keyword">for</span> <span class="ace_identifier">i</span> <span class="ace_keyword">in</span> <span class="ace_support ace_function">range</span><span class="ace_paren ace_lparen">(</span><span class="ace_support ace_function">len</span><span class="ace_paren ace_lparen">(</span><span class="ace_identifier">test_set_x_orig</span><span class="ace_paren ace_rparen">))</span>:
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_indent-guide">    </span>    <span class="ace_identifier">ax</span> <span class="ace_keyword ace_operator">=</span> <span class="ace_identifier">plt</span>.<span class="ace_identifier">subplot</span><span class="ace_paren ace_lparen">(</span><span class="ace_constant ace_numeric">8</span>, <span class="ace_constant ace_numeric">8</span>, <span class="ace_identifier">i</span> <span class="ace_keyword ace_operator">+</span> <span class="ace_constant ace_numeric">1</span><span class="ace_paren ace_rparen">)</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_indent-guide">    </span>    <span class="ace_identifier">x_data</span> <span class="ace_keyword ace_operator">=</span> <span class="ace_identifier">test_set_x_orig</span><span class="ace_paren ace_lparen">[</span><span class="ace_identifier">i</span><span class="ace_paren ace_rparen">]</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_indent-guide">    </span>    <span class="ace_keyword">if</span> <span class="ace_identifier">pred_test</span><span class="ace_paren ace_lparen">[</span><span class="ace_identifier">i</span><span class="ace_paren ace_rparen">]</span> <span class="ace_keyword ace_operator">==</span> <span class="ace_constant ace_numeric">0</span> <span class="ace_keyword">and</span> <span class="ace_identifier">test_set_y_orig</span><span class="ace_paren ace_lparen">[</span><span class="ace_constant ace_numeric">0</span><span class="ace_paren ace_rparen">]</span><span class="ace_paren ace_lparen">[</span><span class="ace_identifier">i</span><span class="ace_paren ace_rparen">]</span> <span class="ace_keyword ace_operator">==</span> <span class="ace_constant ace_numeric">0</span>:
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_indent-guide">    </span><span class="ace_indent-guide">    </span>    <span class="ace_identifier">x_data</span> <span class="ace_keyword ace_operator">=</span> <span class="ace_identifier">x_data</span><span class="ace_keyword ace_operator">/</span><span class="ace_constant ace_numeric">5</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_indent-guide">    </span>    <span class="ace_keyword">if</span> <span class="ace_identifier">true</span><span class="ace_paren ace_lparen">[</span><span class="ace_identifier">i</span><span class="ace_paren ace_rparen">]</span> <span class="ace_keyword ace_operator">==</span> <span class="ace_constant ace_language">False</span>:
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_indent-guide">    </span><span class="ace_indent-guide">    </span>    <span class="ace_identifier">x_data</span><span class="ace_paren ace_lparen">[</span>:, :, <span class="ace_constant ace_numeric">0</span><span class="ace_paren ace_rparen">]</span> <span class="ace_keyword ace_operator">=</span> <span class="ace_identifier">x_data</span><span class="ace_paren ace_lparen">[</span>:, :, <span class="ace_constant ace_numeric">0</span><span class="ace_paren ace_rparen">]</span> <span class="ace_keyword ace_operator">+</span> <span class="ace_paren ace_lparen">(</span><span class="ace_constant ace_numeric">255</span> <span class="ace_keyword ace_operator">-</span> <span class="ace_identifier">x_data</span><span class="ace_paren ace_lparen">[</span>:, :, <span class="ace_constant ace_numeric">0</span><span class="ace_paren ace_rparen">])</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_indent-guide">    </span>    <span class="ace_identifier">im</span> <span class="ace_keyword ace_operator">=</span> <span class="ace_identifier">ax</span>.<span class="ace_identifier">imshow</span><span class="ace_paren ace_lparen">(</span><span class="ace_identifier">x_data</span>, <span class="ace_identifier">interpolation</span><span class="ace_keyword ace_operator">=</span><span class="ace_string">'none'</span>, <span class="ace_identifier">cmap</span><span class="ace_keyword ace_operator">=</span><span class="ace_string">'Reds_r'</span>, <span class="ace_identifier">vmin</span><span class="ace_keyword ace_operator">=</span><span class="ace_constant ace_numeric">0.6</span>, <span class="ace_identifier">vmax</span><span class="ace_keyword ace_operator">=</span><span class="ace_constant ace_numeric">.9</span><span class="ace_paren ace_rparen">)</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_indent-guide">    </span>    <span class="ace_identifier">plt</span>.<span class="ace_identifier">xticks</span><span class="ace_paren ace_lparen">([</span><span class="ace_paren ace_rparen">])</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_indent-guide">    </span>    <span class="ace_identifier">plt</span>.<span class="ace_identifier">yticks</span><span class="ace_paren ace_lparen">([</span><span class="ace_paren ace_rparen">])</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_indent-guide">    </span>    <span class="ace_identifier">plt</span>.<span class="ace_identifier">suptitle</span><span class="ace_paren ace_lparen">(</span><span class="ace_string">u"Num Of Pictrues: %d</span><span class="ace_constant ace_language ace_escape">\n</span><span class="ace_string"> Accuracy: %.2f%%"</span> <span class="ace_keyword ace_operator">%</span> <span class="ace_paren ace_lparen">(</span><span class="ace_support ace_function">len</span><span class="ace_paren ace_lparen">(</span><span class="ace_identifier">test_set_x_orig</span><span class="ace_paren ace_rparen">)</span>, <span class="ace_identifier">accuracy</span><span class="ace_paren ace_rparen">)</span>, <span class="ace_identifier">fontsize</span><span class="ace_keyword ace_operator">=</span><span class="ace_constant ace_numeric">20</span><span class="ace_paren ace_rparen">)</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>    <span class="ace_identifier">plt</span>.<span class="ace_identifier">savefig</span><span class="ace_paren ace_lparen">(</span><span class="ace_string">"cat_pics_test_predict.png"</span><span class="ace_paren ace_rparen">)</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>    <span class="ace_identifier">plt</span>.<span class="ace_identifier">show</span><span class="ace_paren ace_lparen">(</span><span class="ace_paren ace_rparen">)</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>    <span class="ace_comment"># <span class="ace_cjk" style="width:NaNpx">用</span><span class="ace_cjk" style="width:NaNpx">我</span><span class="ace_cjk" style="width:NaNpx">家</span><span class="ace_cjk" style="width:NaNpx">主</span><span class="ace_cjk" style="width:NaNpx">子</span><span class="ace_cjk" style="width:NaNpx">的</span><span class="ace_cjk" style="width:NaNpx">照</span><span class="ace_cjk" style="width:NaNpx">骗</span><span class="ace_cjk" style="width:NaNpx">，</span><span class="ace_cjk" style="width:NaNpx">走</span><span class="ace_cjk" style="width:NaNpx">一</span><span class="ace_cjk" style="width:NaNpx">遍</span><span class="ace_cjk" style="width:NaNpx">模</span><span class="ace_cjk" style="width:NaNpx">型</span><span class="ace_cjk" style="width:NaNpx">，</span><span class="ace_cjk" style="width:NaNpx">观</span><span class="ace_cjk" style="width:NaNpx">察</span><span class="ace_cjk" style="width:NaNpx">其</span><span class="ace_cjk" style="width:NaNpx">识</span><span class="ace_cjk" style="width:NaNpx">别</span><span class="ace_cjk" style="width:NaNpx">率</span><span class="ace_cjk" style="width:NaNpx">，</span><span class="ace_cjk" style="width:NaNpx">因</span><span class="ace_cjk" style="width:NaNpx">为</span><span class="ace_cjk" style="width:NaNpx">只</span><span class="ace_cjk" style="width:NaNpx">有</span><span class="ace_cjk" style="width:NaNpx">一</span><span class="ace_cjk" style="width:NaNpx">张</span><span class="ace_cjk" style="width:NaNpx">图</span><span class="ace_cjk" style="width:NaNpx">片</span><span class="ace_cjk" style="width:NaNpx">，</span><span class="ace_cjk" style="width:NaNpx">所</span><span class="ace_cjk" style="width:NaNpx">以</span><span class="ace_cjk" style="width:NaNpx">识</span><span class="ace_cjk" style="width:NaNpx">别</span><span class="ace_cjk" style="width:NaNpx">率</span><span class="ace_cjk" style="width:NaNpx">要</span><span class="ace_cjk" style="width:NaNpx">么</span> 100% <span class="ace_cjk" style="width:NaNpx">要</span><span class="ace_cjk" style="width:NaNpx">么</span> 0%</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>    <span class="ace_identifier">plt</span>.<span class="ace_identifier">figure</span><span class="ace_paren ace_lparen">(</span><span class="ace_identifier">figsize</span><span class="ace_keyword ace_operator">=</span><span class="ace_paren ace_lparen">(</span><span class="ace_constant ace_numeric">2</span>, <span class="ace_constant ace_numeric">2.6</span><span class="ace_paren ace_rparen">))</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>    <span class="ace_identifier">plt</span>.<span class="ace_identifier">subplots_adjust</span><span class="ace_paren ace_lparen">(</span><span class="ace_identifier">wspace</span><span class="ace_keyword ace_operator">=</span><span class="ace_constant ace_numeric">0</span>, <span class="ace_identifier">hspace</span><span class="ace_keyword ace_operator">=</span><span class="ace_constant ace_numeric">0.1</span><span class="ace_paren ace_rparen">)</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>    <span class="ace_identifier">pred_mycat</span>, <span class="ace_identifier">true</span>, <span class="ace_identifier">accuracy</span> <span class="ace_keyword ace_operator">=</span> <span class="ace_identifier">predict_by_modle</span><span class="ace_paren ace_lparen">(</span><span class="ace_identifier">mycat_set_x</span>, <span class="ace_identifier">mycat_set_y_orig</span>, <span class="ace_identifier">nn</span><span class="ace_paren ace_rparen">)</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>    <span class="ace_keyword">for</span> <span class="ace_identifier">i</span> <span class="ace_keyword">in</span> <span class="ace_support ace_function">range</span><span class="ace_paren ace_lparen">(</span><span class="ace_support ace_function">len</span><span class="ace_paren ace_lparen">(</span><span class="ace_identifier">mycat_set_x_orig</span><span class="ace_paren ace_rparen">))</span>:
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_indent-guide">    </span>    <span class="ace_identifier">ax</span> <span class="ace_keyword ace_operator">=</span> <span class="ace_identifier">plt</span>.<span class="ace_identifier">subplot</span><span class="ace_paren ace_lparen">(</span><span class="ace_constant ace_numeric">1</span>, <span class="ace_constant ace_numeric">1</span>, <span class="ace_identifier">i</span><span class="ace_keyword ace_operator">+</span><span class="ace_constant ace_numeric">1</span><span class="ace_paren ace_rparen">)</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_indent-guide">    </span>    <span class="ace_identifier">x_data</span> <span class="ace_keyword ace_operator">=</span> <span class="ace_identifier">mycat_set_x_orig</span><span class="ace_paren ace_lparen">[</span><span class="ace_identifier">i</span><span class="ace_paren ace_rparen">]</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_indent-guide">    </span>    <span class="ace_keyword">if</span> <span class="ace_identifier">pred_mycat</span><span class="ace_paren ace_lparen">[</span><span class="ace_identifier">i</span><span class="ace_paren ace_rparen">]</span> <span class="ace_keyword ace_operator">==</span> <span class="ace_constant ace_numeric">0</span> <span class="ace_keyword">and</span> <span class="ace_identifier">mycat_set_y_orig</span><span class="ace_paren ace_lparen">[</span><span class="ace_constant ace_numeric">0</span><span class="ace_paren ace_rparen">]</span><span class="ace_paren ace_lparen">[</span><span class="ace_identifier">i</span><span class="ace_paren ace_rparen">]</span> <span class="ace_keyword ace_operator">==</span> <span class="ace_constant ace_numeric">0</span>:
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_indent-guide">    </span><span class="ace_indent-guide">    </span>    <span class="ace_identifier">x_data</span> <span class="ace_keyword ace_operator">=</span> <span class="ace_identifier">x_data</span><span class="ace_keyword ace_operator">/</span><span class="ace_constant ace_numeric">5</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_indent-guide">    </span>    <span class="ace_keyword">if</span> <span class="ace_identifier">true</span><span class="ace_paren ace_lparen">[</span><span class="ace_identifier">i</span><span class="ace_paren ace_rparen">]</span> <span class="ace_keyword ace_operator">==</span> <span class="ace_constant ace_language">False</span>:
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_indent-guide">    </span><span class="ace_indent-guide">    </span>    <span class="ace_identifier">x_data</span><span class="ace_paren ace_lparen">[</span>:, :, <span class="ace_constant ace_numeric">0</span><span class="ace_paren ace_rparen">]</span> <span class="ace_keyword ace_operator">=</span> <span class="ace_identifier">x_data</span><span class="ace_paren ace_lparen">[</span>:, :, <span class="ace_constant ace_numeric">0</span><span class="ace_paren ace_rparen">]</span> <span class="ace_keyword ace_operator">+</span> <span class="ace_paren ace_lparen">(</span><span class="ace_constant ace_numeric">255</span> <span class="ace_keyword ace_operator">-</span> <span class="ace_identifier">x_data</span><span class="ace_paren ace_lparen">[</span>:, :, <span class="ace_constant ace_numeric">0</span><span class="ace_paren ace_rparen">])</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_indent-guide">    </span>    <span class="ace_identifier">im</span> <span class="ace_keyword ace_operator">=</span> <span class="ace_identifier">ax</span>.<span class="ace_identifier">imshow</span><span class="ace_paren ace_lparen">(</span><span class="ace_identifier">x_data</span>, <span class="ace_identifier">interpolation</span><span class="ace_keyword ace_operator">=</span><span class="ace_string">'none'</span>, <span class="ace_identifier">cmap</span><span class="ace_keyword ace_operator">=</span><span class="ace_string">'Reds_r'</span>, <span class="ace_identifier">vmin</span><span class="ace_keyword ace_operator">=</span><span class="ace_constant ace_numeric">0.6</span>, <span class="ace_identifier">vmax</span><span class="ace_keyword ace_operator">=</span><span class="ace_constant ace_numeric">.9</span><span class="ace_paren ace_rparen">)</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_indent-guide">    </span>    <span class="ace_identifier">plt</span>.<span class="ace_identifier">xticks</span><span class="ace_paren ace_lparen">([</span><span class="ace_paren ace_rparen">])</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_indent-guide">    </span>    <span class="ace_identifier">plt</span>.<span class="ace_identifier">yticks</span><span class="ace_paren ace_lparen">([</span><span class="ace_paren ace_rparen">])</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_indent-guide">    </span>    <span class="ace_keyword">if</span> <span class="ace_identifier">pred_mycat</span><span class="ace_paren ace_lparen">[</span><span class="ace_identifier">i</span><span class="ace_paren ace_rparen">]</span> <span class="ace_keyword ace_operator">==</span> <span class="ace_constant ace_numeric">1</span>:
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_indent-guide">    </span><span class="ace_indent-guide">    </span>    <span class="ace_identifier">plt</span>.<span class="ace_identifier">suptitle</span><span class="ace_paren ace_lparen">(</span><span class="ace_string">u"<span class="ace_cjk" style="width:NaNpx">我</span><span class="ace_cjk" style="width:NaNpx">：</span>'<span class="ace_cjk" style="width:NaNpx">我</span><span class="ace_cjk" style="width:NaNpx">主</span><span class="ace_cjk" style="width:NaNpx">子</span><span class="ace_cjk" style="width:NaNpx">是</span><span class="ace_cjk" style="width:NaNpx">喵</span><span class="ace_cjk" style="width:NaNpx">星</span><span class="ace_cjk" style="width:NaNpx">人</span><span class="ace_cjk" style="width:NaNpx">吗</span><span class="ace_cjk" style="width:NaNpx">？</span>'</span><span class="ace_constant ace_language ace_escape">\n</span><span class="ace_string">A I :'<span class="ace_cjk" style="width:NaNpx">是</span><span class="ace_cjk" style="width:NaNpx">滴</span>'"</span>, <span class="ace_identifier">fontproperties</span> <span class="ace_keyword ace_operator">=</span> <span class="ace_identifier">font</span><span class="ace_paren ace_rparen">)</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_indent-guide">    </span>    <span class="ace_keyword">else</span>:
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_indent-guide">    </span><span class="ace_indent-guide">    </span>    <span class="ace_identifier">plt</span>.<span class="ace_identifier">suptitle</span><span class="ace_paren ace_lparen">(</span><span class="ace_string">u"<span class="ace_cjk" style="width:NaNpx">我</span><span class="ace_cjk" style="width:NaNpx">：</span>'<span class="ace_cjk" style="width:NaNpx">我</span><span class="ace_cjk" style="width:NaNpx">主</span><span class="ace_cjk" style="width:NaNpx">子</span><span class="ace_cjk" style="width:NaNpx">是</span><span class="ace_cjk" style="width:NaNpx">喵</span><span class="ace_cjk" style="width:NaNpx">星</span><span class="ace_cjk" style="width:NaNpx">人</span><span class="ace_cjk" style="width:NaNpx">吗</span><span class="ace_cjk" style="width:NaNpx">？</span>'</span><span class="ace_constant ace_language ace_escape">\n</span><span class="ace_string">A I :'<span class="ace_cjk" style="width:NaNpx">唔</span><span class="ace_cjk" style="width:NaNpx">系</span>~<span class="ace_cjk" style="width:NaNpx">唔</span><span class="ace_cjk" style="width:NaNpx">系</span>~'"</span>, <span class="ace_identifier">fontproperties</span> <span class="ace_keyword ace_operator">=</span> <span class="ace_identifier">font</span><span class="ace_paren ace_rparen">)</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>    <span class="ace_identifier">plt</span>.<span class="ace_identifier">savefig</span><span class="ace_paren ace_lparen">(</span><span class="ace_string">"cat_pics_my_predict.png"</span><span class="ace_paren ace_rparen">)</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>    <span class="ace_identifier">plt</span>.<span class="ace_identifier">show</span><span class="ace_paren ace_lparen">(</span><span class="ace_paren ace_rparen">)</span>
</div></div></div></pre>
<hr>
<h1>六.结论</h1>
<h3>1. 神经网络模型的输出结果，标注到了图片上并展示出来，规则是：</h3>
<p>结果展示说明：</p>
<blockquote>
<p>【识别正确】：</p>
<ol>
<li>原图是猫，识别为猫  --&gt; 原图显示</li>
<li>原图不是猫，识别为不是猫 --&gt; 降低显示亮度</li>
</ol>
<p>【识别错误】：</p>
<ol>
<li>原图是猫，但是识别为不是猫 --&gt; 标红显示</li>
<li>原图不是猫， 但是识别成猫 --&gt; 标红显示</li>
</ol>
</blockquote>
<p>图片标题会显示Accuracy（准确度），准确度的计算公式是： 识别正确图片数/图片总数。</p>
<h3>2. 模型训练完成后，把训练用的209张图片用训练好的模型识别一遍，观察结果：可以看到，迭代1w次的模型，识别训练图集，准确度是 100% 的：</h3>
<p><img src="resources/5352CC63BE1E522FF056853AA1A26253.png" alt="cat_pics_train_predict.png" width="593" height="1206"></p>
<h3>3. 模型训练完成后，使用测试图集用训练好的模型识别一遍，观察结果：可以看到，迭代1w次的模型，识别训练图集，准确度只有 78%：</h3>
<p><img src="resources/18911F9E66B3C88DEC4109AA4E8ED5FB.png" alt="cat_pics_test_predict.png" width="470" height="472"></p>
<h3>4. 看看模型能不能认出我主子是喵星人，看样子，它是认出来了：</h3>
<p><img src="resources/31E1ECF3F19D72C84CA3DA925C0CB9DD.png" alt="cat_pics_my_predict.png" width="144" height="167"></p>
<hr>
<h1>七.对结果进一步分析，引出一系列问题</h1>
<ol>
<li>
<p>抛出一个问题：<br>
为什么用测试图集验证模型，识别率只有78%？在我尝试过改变神经网络结构设计，参数调参后，仍然无法提高识别率，为什么呢？</p>
</li>
<li>
<p>不算彻底的解答：</p>
<ul>
<li>
<p>也许是我水平有限，调参姿势不对？姿势帅并不是万能的，我们应该从更深层次的原理进行分析。</p>
</li>
<li>
<p>有人说，你训练数据少了，好像有那么些道理。其实是可以给模型输入更多图片的特征是个不错的办法，比如旋转一下，图片内容放大缩小，挪挪位置等。但是Andrew Ng也说过，过分追求训练数据收集是一条不归路。在同等训练数据集下，有更好的办法吗？由此引出下一个问题。</p>
</li>
</ul>
</li>
<li>
<p>刨根问底：<br>
想要知道为什么MLP识别度难以做到很高，撇开网络结构，调参，训练数据先不谈。我们应该从MLP身上找找茬。搞清楚我们目标，是提高对图片进行分类识别，那么在使用MLP实现这个目标时，它自身是否有缺陷，导致实现这个目标遇到了困难。那么解决了这些困难，就找到了解决问题的方法。</p>
</li>
<li>
<p>MLP在做图片分类识别的缺陷：</p>
</li>
</ol>
<ul>
<li>
<p>神经元是全连接的方式构成的神经网络，全连接情况下，假设图片是1k*1k像素大小，那么隐藏层个数和输入层尺寸一致时，不考虑RGB颜色通道，单通道下，权重w参数个数会是： </p><div class="MathJax_Display" role="textbox" aria-readonly="true" style="text-align: center;"><span class="MathJax" id="MathJax-Element-8-Frame" style=""><nobr><span class="math" id="MathJax-Span-148" style="width: 20.828em; display: inline-block;"><span style="display: inline-block; position: relative; width: 18.75em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.474em, 1000em, 2.903em, -0.459em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-149"><span class="mo" id="MathJax-Span-150" style="font-family: STIXGeneral-Regular;">(</span><span class="msubsup" id="MathJax-Span-151"><span style="display: inline-block; position: relative; width: 1.483em; height: 0px;"><span style="position: absolute; clip: rect(1.689em, 1000em, 2.717em, -0.396em); top: -2.534em; left: 0em;"><span class="mn" id="MathJax-Span-152" style="font-family: STIXGeneral-Regular;">10</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.721em; left: 1.014em;"><span class="mn" id="MathJax-Span-153" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">3</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-154" style="font-family: STIXGeneral-Regular; padding-left: 0.25em;">∗</span><span class="msubsup" id="MathJax-Span-155" style="padding-left: 0.25em;"><span style="display: inline-block; position: relative; width: 1.483em; height: 0px;"><span style="position: absolute; clip: rect(1.689em, 1000em, 2.717em, -0.396em); top: -2.534em; left: 0em;"><span class="mn" id="MathJax-Span-156" style="font-family: STIXGeneral-Regular;">10</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.721em; left: 1.014em;"><span class="mn" id="MathJax-Span-157" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">3</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-158"><span style="display: inline-block; position: relative; width: 0.807em; height: 0px;"><span style="position: absolute; clip: rect(1.689em, 1000em, 2.88em, -0.478em); top: -2.534em; left: 0em;"><span class="mo" id="MathJax-Span-159" style="font-family: STIXGeneral-Regular;">)</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.721em; left: 0.338em;"><span class="mn" id="MathJax-Span-160" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">2</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-161" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">=</span><span class="msubsup" id="MathJax-Span-162" style="padding-left: 0.313em;"><span style="display: inline-block; position: relative; width: 1.82em; height: 0px;"><span style="position: absolute; clip: rect(1.689em, 1000em, 2.717em, -0.396em); top: -2.534em; left: 0em;"><span class="mn" id="MathJax-Span-163" style="font-family: STIXGeneral-Regular;">10</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.721em; left: 1.014em;"><span class="texatom" id="MathJax-Span-164"><span class="mrow" id="MathJax-Span-165"><span class="mn" id="MathJax-Span-166" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">12</span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-167" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">=</span><span class="mn" id="MathJax-Span-168" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">1</span><span class="texatom" id="MathJax-Span-169"><span class="mrow" id="MathJax-Span-170"><span class="mo" id="MathJax-Span-171"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 90%; font-style: normal; font-weight: normal;">千</span></span></span></span><span class="texatom" id="MathJax-Span-172"><span class="mrow" id="MathJax-Span-173"><span class="mo" id="MathJax-Span-174"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 90%; font-style: normal; font-weight: normal;">亿</span></span></span></span><span class="texatom" id="MathJax-Span-175"><span class="mrow" id="MathJax-Span-176"><span class="mo" id="MathJax-Span-177"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 90%; font-style: normal; font-weight: normal;">（</span></span></span></span><span class="texatom" id="MathJax-Span-178"><span class="mrow" id="MathJax-Span-179"><span class="mo" id="MathJax-Span-180"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 90%; font-style: normal; font-weight: normal;">没</span></span></span></span><span class="texatom" id="MathJax-Span-181"><span class="mrow" id="MathJax-Span-182"><span class="mo" id="MathJax-Span-183"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 90%; font-style: normal; font-weight: normal;">数</span></span></span></span><span class="texatom" id="MathJax-Span-184"><span class="mrow" id="MathJax-Span-185"><span class="mo" id="MathJax-Span-186"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 90%; font-style: normal; font-weight: normal;">错</span></span></span></span><span class="mn" id="MathJax-Span-187" style="font-family: STIXGeneral-Regular;">0</span><span class="texatom" id="MathJax-Span-188"><span class="mrow" id="MathJax-Span-189"><span class="mo" id="MathJax-Span-190"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 90%; font-style: normal; font-weight: normal;">的</span></span></span></span><span class="texatom" id="MathJax-Span-191"><span class="mrow" id="MathJax-Span-192"><span class="mo" id="MathJax-Span-193"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 90%; font-style: normal; font-weight: normal;">话</span></span></span></span><span class="texatom" id="MathJax-Span-194"><span class="mrow" id="MathJax-Span-195"><span class="mo" id="MathJax-Span-196"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 90%; font-style: normal; font-weight: normal;">）</span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.336em; vertical-align: -0.285em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-8">(10^3*10^3)^2=10^{12}=1千亿（没数错0的话）</script><br>
如果图片再大点，参数膨胀到不可想象，直接导致的负面效果是：<p></p>
<ul>
<li>参数过多，计算量庞大</li>
<li>全连接情况下，过深的网络容易导致梯度消失，模型难以训练</li>
</ul>
</li>
<li>
<p>MLP全连接的情况下，无法做到图片的形变识别。怎么理解这个词呢，拿手写数字举个例子，比如写8，每个人书写习惯不一样，有的人写的很正，但有的人写歪了点，上半部分小，下半部分大，等等。这时候，MLP的缺点就显现出来了，同一张图片，旋转，或者稍微平移形变一下，它无法识别。你可以通过增加更多特征给模型，但这不是本质上的解决该问题的方法，而是对训练的优化手段。</p>
</li>
</ul>
<h1>八. 总结要解决的问题，离下一个坑就不远了</h1>
<p>上面已经列举了要解决的几个问题，这里总结一下：</p>
<ul>
<li>
<p>我们要解决参数膨胀带来的计算量庞大的问题</p>
</li>
<li>
<p>优化参数量之后，如何在同等训练数据集不变的情况下，如何提取更多特征</p>
</li>
<li>
<p>在输入有一定的旋转平移伸缩时，仍能正确识别</p>
</li>
</ul>
<blockquote>
<p>能解决以上问题的众所周知，就是CNN以及众多更先进的神经网络模型了。本文作为一篇引子文章，也是CNN的导火索。<br>
代码在你手中，把第一层隐藏层设计成和输入层一样大，即 layers_dims = [12288, 12288, 20, 7, 5, 1]。还只是64*64的小图片而已，那龟速，我和我的小破笔记本都不能忍啊。这也是为什么大神们发明CNN的原因之一吧！</p>
</blockquote>
<h3><strong>AI从入门到放弃，这也只是沧海一粟，你怕了吗？</strong></h3>
</div></div>
      <script></script>
    </body>
    </html>
  